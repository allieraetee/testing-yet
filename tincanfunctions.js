
		/*
 * Copyright (C) 2007 Trivantis Corporation
 */

	
var tcFinishCalled=false;var TinCanVersion='1.0';var TinCanStatus='';var TinCanScore='';var TinCanCompStatus='';var TinCanSatStatus='';var TinCanUpdPending=false;var TinCanProcessing=false;var TinCanBookmark='';var TinCanSuspend='';var bDelayTCSuspend=false;var tc_driver=null;var tcapi_cache=null;var bTCCalledFinish=false;var bTCLoaded=false;var bTCStatusWasSet=false;var dTCStart=null;var dTCEnd=null;var intAccumulatedMS=0;var blnOverrodeTime=false;var intTimeOverrideMS=null;var intError=0;var strErrorDesc="";function convertTotalMills(A){var B=0;var C=0;var D=0;while (A>=3600000){D+=1;A-=3600000;}while (A>=60000){C+=1;A-=60000;}while (A>=1000){B+=1;A-=1000;};if (D<10) D="0"+D;if (C<10) C="0"+C;if (B<10) B="0"+B;var E=D+":"+C+":"+B;return E;};function LMSGetValue(A){if (tcFinishCalled==true) return "";else{var B='';if (A=='cmi.core.lesson_status') B=TinCanStatus;else if (A=='cmi.core.student_name') B=getStudentName(tc_driver.actor);else if (A=='cmi.core.lesson_location') B=LMSGetBookmark();else if (A=='cmi.suspend_data'&&TinCanSuspend!=null&&TinCanSuspend.length>0) B=TinCanSuspend;else if (A=='cmi.core.session_time') B=convertTotalMills(GetSessionAccumulatedTime());else{ResetErrorStatus();if (bTCLoaded) B=TinCanGetInfo(tc_driver,A);else B="";};if (B==null){if (A=='cmi.core.score.raw') B=TinCanScore;else if (A=='cmi.suspend_data') B='';};if (B!=null){if (A=='cmi.core.score.raw') TinCanScore=B;else if (A=='cmi.suspend_data') TinCanSuspend=B;};trivLogMsg('LMSGetValue for '+A+' = ['+B+']',16);return B;}};function LMSSetValue(A,B){if (tcFinishCalled!=true){if (A=='cmi.core.lesson_status') TCSetStatus(B);else{ResetErrorStatus();if (bTCLoaded){if (A=='cmi.suspend_data'&&B.length>=TinCanSuspend.length-1&&B.length<=TinCanSuspend.length+1) bDelayTCSuspend=true;else{TinCanSetInfo(tc_driver,A,B);if (bDelayTCSuspend){TinCanSetInfo(tc_driver,'cmi.suspend_data',TinCanSuspend);bDelayTCSuspend=false;}}}};if (A=='cmi.core.score.raw'){TinCanScore=B;TinCanUpdPending=true;}else if (A=='cmi.suspend_data') TinCanSuspend=B;trivLogMsg('LMSSetValue for '+A+' to ['+B+']',16);};return;};function CheckValidInt(A){var B=new String(A);if (B.indexOf("-",0)==0) B=B.substring(1,B.length-1);var C=new RegExp("[^0-9]");if (B.search(C)==-1) return true;return false;};function ConvertToTime(A){trivLogMsg("In ConvertToTime ms="+A,16);var B="";var C;var D;var E;var F;var G;var H;var I;var J=100*60*60*24*(((365*4)+1)/48);C=Math.floor(A/10);I=Math.floor(C/(J*12));C-=(I*J*12);H=Math.floor(C/J);C-=(H*J);G=Math.floor(C/(100*60*60*24));C-=(G*100*60*60*24);F=Math.floor(C/(100*60*60));C-=(F*100*60*60);E=Math.floor(C/(100*60));C-=(E*100*60);D=Math.floor(C/100);C-=(D*100);if (I>0){B+=I+"Y";};if (H>0){B+=H+"M";};if (G>0){B+=G+"D";};if ((C+D+E+F)>0){B+="T";if (F>0){B+=F+"H";};if (E>0){B+=E+"M";};if ((C+D)>0){B+=D;if (C>0){B+="."+C;};B+="S";}};if (B==""){B="0S";};B="P"+B;trivLogMsg("Returning-"+B,16);return B;};function IsValidDec(A){A=new String(A);if (A.search(/[^.\d-]/)>-1) return false;if (A.search("-")>-1){if (A.indexOf("-",1)>-1) return false;};if (A.indexOf(".")!=A.lastIndexOf(".")) return false;if (A.search(/\d/)<0) return false;return true;};function isalnum(A){return A.search(/\w/)>=0;};function trimleft(A){A=new String(A);return (A.replace(/^\s+/,''));};function trimright(A){A=new String(A);return (A.replace(/\s+$/,''));};function isurl(A){return A!=null&&(A.indexOf("http://")==0||A.indexOf("https://")==0);};function TinCanConfigObject(A,B){trivLogMsg("TinCanConfigObject",16);var C=["endpoint","auth"];var D=["activity_id","grouping","activity_platform","registration"];var E={activity_id:"activityId",grouping:"grouping",activity_platform:"activityPlatform",registration:"registration"};var F={};var G=parseSearch();var H;var i;var I={_isIE:(typeof XDomainRequest!=="undefined"),recordStores:[],J:null,agentJSON:null,activityId:null,A:{},B:{},activityPlatform:null,grouping:null,registration:null};if (G.hasOwnProperty("actor")){try{var J=JSON.parse(G.actor);if (J.mbox!==undefined){if (J.name!==undefined) I.actor={name:J.name,mbox:J.mbox};else I.actor={mbox:J.mbox};}else I.actor={objectType:J.objectType,name:J.name[0],account:{name:J.account[0].accountName,homePage:J.account[0].accountServiceHomePage}};I.agentJSON=JSON.stringify(I.actor);delete G.actor;} catch (ex){trivLogMsg("TinCanConfigObject - failed to parse actor: "+ex,16);}};for (i=0;i<D.length;i+=1){H=D[i];if (G.hasOwnProperty(H)){I[E[H]]=G[H];delete G[H];}};if (G.hasOwnProperty("endpoint")){for (i=0;i<C.length;i+=1){H=C[i];if (G.hasOwnProperty(H)){F[H]=G[H];delete G[H];}};F.extended=G;F.allowFail=false;TinCanAddRecordStore(I,F);};I.activityName=A;I.activityDesc=B;I.courseActivityObject={"id":I.activityId,"definition":{"name":{"en-US":I.activityName},"description":{"en-US":I.activityDesc}}};return I;};function TinCanAddRecordStore(A,B){var C;var D;var E;trivLogMsg("TinCanAddRecordStore",16);if (!B.hasOwnProperty("endpoint")){alert("[error] LRS invalid: no endpoint");throw {code:3,mesg:"LRS invalid: no endpoint"};};if (!B.hasOwnProperty("allowFail")) B.allowFail=true;C=B.endpoint.toLowerCase().match(/^(.+:)\/\/([^:\/]+):?(\d+)?(\/.*)?$/);D=location.protocol.toLowerCase()===C[1];E=(!D||location.hostname.toLowerCase()!==C[2]||location.port!==(C[3]!==null?C[3]:(C[1]==='http:'?'80':'443')));if (E&&A._isIE){if (D){B._requestMode="ie";A.recordStores.push(B);}else{if (B.allowFail) alert("[warning] LRS invalid: cross domain request for differing scheme in IE");else{alert("[error] LRS invalid: cross domain request for differing scheme in IE");throw {code:2,mesg:"LRS invalid: cross domain request for differing scheme in IE"};}}}else{B._requestMode="native";trivLogMsg("  "+JSON.stringify(B,null,4),16);A.recordStores.push(B);}};function TinCanSendStatement(A,B,C){var D,E=GenerateRandomID(),F,G=A.recordStores.length,i;_TinCanPrepareStatement(A,B);var H=JSON.stringify(B);trivLogMsg("TinCanSendStatement:\n"+H+"\n",16);if (G>0){trivLogMsg("  sending...",16);if (G===1) F=C;else{if (typeof C==="function"){F=function(){trivLogMsg("TinCanSendStatement - cbW: "+G,16);if (G>1) G-=1;else if (G===1) C.apply(this,arguments);};}};for (i=0;i<G;i+=1){D=A.recordStores[i];_TinCanXHR_request(D,"statements?statementId="+E,"PUT",H,F);}}};function TinCanSendMultiStatements(A,B,C){var D,E,F=A.recordStores.length,i;if (!B||!B.length||B.length<1) return;for (i=0;i<B.length;i++) _TinCanPrepareStatement(A,B[i]);var G=JSON.stringify(B);trivLogMsg("  TinCanSendMultiStatements:\n"+G+"\n",16);if (F>0){trivLogMsg("  TinCanSendMultiStatements: sending ...",16);if (F===1) E=C;else{if (typeof C==="function"){E=function(){trivLogMsg("TinCanSendMultiStatements - cbW: "+F,16);if (F>1) F-=1;else if (F===1) C.apply(this,arguments);};}};for (i=0;i<F;i+=1){D=A.recordStores[i];_TinCanXHR_request(D,"statements","POST",G,E);}}};function TinCanGetInfo(A,B,C){trivLogMsg("TinCanGetInfo: "+B,16);if (A.recordStores.length>0){var D=A.recordStores[0];var E="activities/state?activityId="+encodeURIComponent(A.activityId)+"&agent="+encodeURIComponent(A.agentJSON)+"&stateId="+encodeURIComponent(B);if (A.registration!==null) E+="&registration="+encodeURIComponent(A.registration);var F=_TinCanXHR_request(D,E,"GET",null,C,true);return (typeof F==="undefined"||F.status===404)?null:F.responseText;}};function TinCanSetInfo(A,B,C,D){trivLogMsg("TinCanSetInfo: "+B,16);if (A.recordStores.length>0){var E=A.recordStores[0];var F="activities/state?activityId="+encodeURIComponent(A.activityId)+"&agent="+encodeURIComponent(A.agentJSON)+"&stateId="+encodeURIComponent(B);if (A.registration!==null) F+="&registration="+encodeURIComponent(A.registration);_TinCanXHR_request(E,F,"PUT",C,D);}};function TinCanISODateString(d){function pad(C,n){if (C==null) C=0;if (n==null) n=2;var A=Math.pow(10,n-1);var B=C.toString();while (C<A&&A>1){B='0'+B;A=A/10;};return B;};return d.getUTCFullYear()+'-'+pad(d.getUTCMonth()+1)+'-'+pad(d.getUTCDate())+'T'+pad(d.getUTCHours())+':'+pad(d.getUTCMinutes())+':'+pad(d.getUTCSeconds())+'.'+pad(d.getUTCMilliseconds(),3)+'Z';};function _TinCanPrepareStatement(A,B){if (B.actor===undefined) B.actor=A.actor;if (A.grouping||A.registration||A.activityPlatform){if (!B.context) B.context={};};if (A.registration) B.context.registration=A.registration;if (A.activity_platform) B.context.platform=A.activityPlatform;};function _TinCanXHR_request(A,B,C,D,E,F,G){var H;var I=false;var J=(A._requestMode==="ie");var K;var L;var M;var N;var O=A.endpoint+B;trivLogMsg("_TinCanXHR_request: "+B,16);if (A.extended!==undefined){M=[];for (var P in A.extended){if (A.extended[P]!=null&&A.extended[P].length>0) M.push(P+"="+encodeURIComponent(A.extended[P]));};if (M.length>0) O+=(O.indexOf("?")>-1?"&":"?")+M.join("&");};var Q={};Q["Content-Type"]="application/json";Q["Authorization"]=A.auth;Q["X-Experience-API-Version"]=TinCanVersion;if (G!==null){for (var R in G) Q[R]=G[R];};if (A._requestMode==="native"){trivLogMsg("_TinCanXHR_request using XMLHttpRequest",16);H=new XMLHttpRequest();H.open(C,O,E!==undefined);for (var R in Q) H.setRequestHeader(R,Q[R]);}else if (J){trivLogMsg("_TinCanXHR_request using XDomainRequest",16);K=_TinCanGetIEModeRequest(C,O,Q,D);H=new XDomainRequest();H.open(K.method,K.url);};function _TinCanXHR_requestComplete(){trivLogMsg("_TinCanXHR_requestComplete: "+I+", xhr.status: "+H.status,16);var T;if (!I){I=true;T=(F&&H.status===404);if (H.status===undefined||(H.status>=200&&H.status<400)||T){if (E) E(H);else{L=H;return H;}}else{if (H.status>0) alert("[warning] There was a problem communicating with the Learning Record Store. ("+H.status+" | "+H.responseText+")");return H;}}else return L;};H.onreadystatechange=function(){if (H.readyState===4){_TinCanXHR_requestComplete();}};H.onload=_TinCanXHR_requestComplete;H.onerror=_TinCanXHR_requestComplete;H.send(J?K.data:D);if (!E){if (J){N=1000+Date.now();trivLogMsg("_TinCanXHR_request: until: "+N+", finished: "+I,16);while (Date.now()<N&&!I) __delay();};return _TinCanXHR_requestComplete();}};function _TinCanGetIEModeRequest(A,B,C,D){var E=B;var F=[];var G=E.indexOf('?');var H;trivLogMsg("_TinCanGetIEModeRequest",16);if (G>0){F.push(E.substr(G+1));E=E.substr(0,G);};E=E+'?method='+A;if (C!==null){for (var I in C) F.push(I+"="+encodeURIComponent(C[I]));};if (D!==null) F.push('content='+encodeURIComponent(D));H={A:"POST",B:E,C:{},D:F.join("&")};return H;};function __delay(){var A=new XMLHttpRequest();var B=window.location+'?forcenocache='+GenerateRandomID();A.open('GET',B,false);A.send(null);};function parseSearch(){var A={};function buildValue(F){if (/^\s*$/.test(F)) return null;if (/^(true|false)$/i.test(F)) return F.toLowerCase()==="true";if (isFinite(F)) return parseFloat(F);return F;};var B=window.parent.location.search;if (B.length<=1) B=window.location.search;if (B.length>1){var C;var D;var E=B.substr(1).split("&");for (D=0;D<E.length;D++){C=E[D].split("=");A[unescape(C[0])]=C.length>1?buildValue(unescape(C[1])):null;}};trivLogMsg("parseSearch: "+JSON.stringify(A,null,4),16);return A;};function GenerateRandomID(){return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(c){var r=Math.random()*16|0,v=c=='x'?r:(r&0x3|0x8);return v.toString(16);});};if (!window.JSON){window.JSON={parse:function(A){return eval("("+A+")");},stringify:function(A){if (A instanceof Object){var B="";if (A.constructor===Array){for (var C=0;C<A.length;B+=this.stringify(A[C])+",",C++){};return "["+B.substr(0,B.length-1)+"]";};if (A.toString!==Object.prototype.toString) return "\""+A.toString().replace(/"/g,"\\$&")+"\"";for (var D in A) B+="\""+D.replace(/"/g,"\\$&")+"\":"+this.stringify(A[D])+",";return "{"+B.substr(0,B.length-1)+"}";};return typeof A==="string"?"\""+A.replace(/"/g,"\\$&")+"\"":String(A);}};};function LMSInitialize(A,B){trivLogMsg("In LMSInitialize",16);tcapi_cache={totalPrevDuration:null,statementQueue:[]};tc_driver=TinCanConfigObject(A,B);TinCanGetInfo(tc_driver,'cumulative_time',function(D){if (D.status<400){if (D.responseText.match(/^\d+$/)) tcapi_cache.totalPrevDuration=Number(D.responseText);else tcapi_cache.totalPrevDuration=0;trivLogMsg('tcapi_cache.totalPrevDuration='+tcapi_cache.totalPrevDuration);}});TinCanStatus='attempted';TinCanProcessing=true;var C={"verb":{"id":"http://adlnet.gov/expapi/verbs/attempted","display":{"en-US":"attempted"}},"object":tc_driver.courseActivityObject,"timestamp":TinCanISODateString(new Date())};TinCanSendStatement(tc_driver,C,function(E){});InitializeExecuted(true,"");return true;};function LMSFinish(){trivLogMsg("In LMSFinish",16);tcFinishCalled=true;TinCanFinish("SUSPEND");window.top.close();return true;};function getStudentName(A){if (A===undefined) return "";if (A.name!==undefined) return A.name;if (A.lastName!=undefined&&A.firstName!=undefined) return A.firstName+" "+A.lastName;if (A.familyName!=undefined&&A.givenName!=undefined) return A.givenName+" "+A.familyName;if (A.mbox!==undefined) return A.mbox.replace('mailto:','');if (A.account!==undefined) return A.account.accountName;return truncateString(JSON.stringify(A),20);};function LMSRecordInteraction(A,B,C,D,E,F,G,H,I,J){var K=createValidIdentifier(window.strTestName),L,M=false,N={"id":tc_driver.activityId+"/"+createValidIdentifier(A),"definition":{"name":{'en-US':E},"description":{'en-US':E},"type":"http://adlnet.gov/expapi/activities/cmi.interaction","interactionType":J,"correctResponsesPattern":[D]}},O=N.definition;ResetErrorStatus();switch (J) {case "matching":O.source=[];O.target=[];break;case "performance":O.steps=[];break;case "sequencing":O.choices=[];break;case "likert":O.scale=[];M=true;break;case "true-false":case "choice":case "fill-in":case "numeric":case "other":break;default:trivLogMsg("LMSRecordInteraction received an invalid interactType of "+J,16);return false;};if (N.id!==null){if (I==null) I=TinCanISODateString(new Date());L={verb:{"id":"http://adlnet.gov/expapi/verbs/answered","display":{"en-US":"answered"}},object:N,timestamp:I,context:{contextActivities:{parent:{"id":tc_driver.activityId+'/'+K,"definition":{"name":{"en-US":window.strTestName},"description":{"en-US":window.strTestName}}},grouping:tc_driver.courseActivityObject}}};if (B!=null){if (M) L.result={response:B};else L.result={response:B,success:C};};tcapi_cache.statementQueue.push(L);};return true;};function TCAPI_SetSuspended(){if (TinCanProcessing){TinCanProcessing=false;TinCanUpdPending=true;};return true;};function TCAPI_GetLastError(){if (intTCAPIError==='') return 0;else return intTCAPIError;};function InitializeExecuted(A,B){trivLogMsg("In InitializeExecuted, blnSuccess="+A+", strErrorMessage="+B,16);if (!A){trivLogMsg("ERROR - LMS Initialize Failed",16);if (B=="") B="An Error Has Occurred";DisplayError(B);return;};bTCLoaded=true;dTCStart=new Date();return;};function TinCanFinish(A){trivLogMsg("In TinCanFinish, ExitType="+A,16);ResetErrorStatus();if (bTCLoaded&&!bTCCalledFinish){bTCCalledFinish=true;if (A==="SUSPEND"){TinCanSetInfo(tc_driver,'cumulative_time',GetPreviouslyAccumulatedTime()+GetSessionAccumulatedTime());TCAPI_SetSuspended();};LMSCommit();bTCLoaded=false;};return true;};function DisplayError(A){trivLogMsg("In DisplayError, strMessage="+A,16);alert("An error has occured:\n\n"+A);};function GetLastError(){trivLogMsg("In GetLastError, intError="+intError,16);if (intError!=0){trivLogMsg("Returning API Error",16);return intError;}else if (bTCLoaded&&TCAPI_GetLastError()!=0){trivLogMsg("Returning LMS Error",16);return 1;};trivLogMsg("Returning No Error",16);return 0;};function GetLastLMSErrorCode(){var A=TCAPI_GetLastError();trivLogMsg("In GetLastLMSErrorCode, intError="+intError,16);if (bTCLoaded&&A!=0){trivLogMsg("Returning LMS Error: "+A,16);return A;};trivLogMsg("Returning No Error",16);return 0;};function GetLastErrorDesc(){trivLogMsg("In GetLastErrorDesc",16);if (intError!=0){trivLogMsg("Returning API Error - "+strErrorDesc,16);return strErrorDesc;}else if (bTCLoaded&&TCAPI_GetLastError()!=0){trivLogMsg("returning LMS Error "+strTCAPIErrorString+"\n"+strTCAPIErrorDiagnostic,16);return strTCAPIErrorString+"\n"+strTCAPIErrorDiagnostic;};trivLogMsg("Returning No Error",16);return "";};function SetErrorInfo(A,B){trivLogMsg("In SetErrorInfo - Num="+A+" Desc="+B,16);intError=A;strErrorDesc=B;};function ResetErrorStatus(){intTCAPIError='';strTCAPIErrorString="";strTCAPIErrorDiagnostic="";};function LMSCommit(){trivLogMsg("In LMSCommit",16);ResetErrorStatus();if (!bTCLoaded) return false;if (!blnOverrodeTime){dTCEnd=new Date();AccumulateTime();dTCStart=new Date();};var A;if (TinCanUpdPending&&!(bTCLoaded&&TinCanStatus=='attempted')){A={"verb":{"id":"http://adlnet.gov/expapi/verbs/"+TinCanStatus,"display":{"en-US":TinCanStatus}},"timestamp":TinCanISODateString(new Date()),"object":{"id":tc_driver.activityId,"definition":{"name":{"en-US":tc_driver.activityName},"description":{"en-US":tc_driver.activityDesc}}},"result":{}};if (TinCanCompStatus!==''||!TinCanProcessing) A.result.duration=ConvertToTime(GetSessionAccumulatedTime()+GetPreviouslyAccumulatedTime());if (TinCanCompStatus!=='') A.result.completion=(TinCanCompStatus=='true');if (TinCanSatStatus!=='') A.result.success=(TinCanSatStatus=='true');if (TinCanScore!=='') A.result.score={"raw":parseInt(TinCanScore,10),"min":0,"max":100};tcapi_cache.statementQueue.push(A);TinCanUpdPending=false;};if (tcapi_cache.statementQueue.length>0){TinCanSendMultiStatements(tc_driver,tcapi_cache.statementQueue);tcapi_cache.statementQueue=[];};return true;};function GetPreviouslyAccumulatedTime(){trivLogMsg("In GetPreviouslyAccumulatedTime",16);ResetErrorStatus();if (!bTCLoaded) return 0;if (tcapi_cache.totalPrevDuration===null){var A=TinCanGetInfo(tc_driver,'cumulative_time');if (A===null){A=0;};tcapi_cache.totalPrevDuration=Number(A);};trivLogMsg("PreviouslyAccumulatedTime="+tcapi_cache.totalPrevDuration,16);return tcapi_cache.totalPrevDuration;};function AccumulateTime(){trivLogMsg("In AccumulateTime dTCStart="+dTCStart+" dTCEnd="+dTCEnd+" intAccumulatedMS="+intAccumulatedMS,16);if (dTCEnd!=null&&dTCStart!=null){intAccumulatedMS+=(dTCEnd.getTime()-dTCStart.getTime());trivLogMsg("intAccumulatedMS="+intAccumulatedMS,16);}};function GetSessionAccumulatedTime(){trivLogMsg("In GetSessionAccumulatedTime",16);ResetErrorStatus();dTCEnd=new Date();AccumulateTime();if (dTCStart!=null) dTCStart=new Date();dTCEnd=null;trivLogMsg("Returning "+intAccumulatedMS,16);return intAccumulatedMS;};function SetSessionTime(A){trivLogMsg("In SetSessionTime",16);ResetErrorStatus();if (!CheckValidInt(A)){SetErrorInfo(2,"Invalid intMilliseconds passed to SetSessionTime (not an integer), intMilliseconds="+A);return false;};A=parseInt(A,10);if (A<0){SetErrorInfo(2,"Invalid intMilliseconds passed to SetSessionTime (must be greater than 0), intMilliseconds="+A);return false;};blnOverrodeTime=true;intTimeOverrideMS=A;return true;};function createValidIdentifier(A){return encodeURIComponent(stringToSlug(A));};function Trim(A){return A.replace(/^\s*/,"").replace(/\s*$/,"");};function TCSetStatus(A){trivLogMsg("In TCSetStatus "+A,16);if (!bTCLoaded) return false;bTCStatusWasSet=true;TinCanStatus=A;TinCanUpdPending=true;if (A=='attempted'){TinCanSatStatus='true';TinCanCompStatus='';TinCanProcessing=true;}else if (A=='passed'||A=='completed'){TinCanSatStatus='true';TinCanCompStatus='true';TinCanProcessing=false;}else if (A=='failed'){TinCanSatStatus='false';TinCanCompStatus='true';TinCanProcessing=false;};return true;};function LMSGetBookmark(){trivLogMsg("In LMSGetBookmark");ResetErrorStatus();if (!bTCLoaded) return TinCanBookmark;if (TinCanBookmark==null||TinCanBookmark.length==0){TinCanBookmark=TinCanGetInfo(tc_driver,'bookmark');if (TinCanBookmark===null) TinCanBookmark="";};trivLogMsg("Bookmark="+TinCanBookmark);return TinCanBookmark;};function LMSSetBookmark(A,B){trivLogMsg("In LMSSetBookmark - strHtml="+A+", strName="+B);ResetErrorStatus();if (!bTCLoaded) return false;TinCanSetInfo(tc_driver,'bookmark',A);TinCanSendStatement(tc_driver,{verb:{"id":"http://adlnet.gov/expapi/verbs/experienced","display":{"en-US":"experienced"}},timestamp:TinCanISODateString(new Date()),object:{id:tc_driver.activityId+"/"+A,definition:{name:{"en-US":B}}},context:{contextActivities:{parent:tc_driver.courseActivityObject,grouping:tc_driver.courseActivityObject}}},function(){});TinCanBookmark=A;return true;};function putSCORMInteractions(A,B,C,D,E,F,G,H,I,J){if (B=='null') B=null;trivLogMsg("putSCORMInteractions ["+A+"]["+B+"]["+C+"]["+D+"]["+E+"]["+F+"]["+G+"]["+H+"]["+I+"]["+J+"]");return LMSRecordInteraction(A,G,(H==='correct'?true:false),E,J,F,I,B,C,D);};function LMSTinCanStatement(A,B,C){trivLogMsg("In LMSTinCanStatement - strVerb="+A+", strObj="+B);var D=B.indexOf('{')<0?createValidIdentifier(B):B;var E={verb:{"id":"http://adlnet.gov/expapi/verbs/"+A,"display":{"en-US":A}},timestamp:TinCanISODateString(new Date()),object:{id:tc_driver.activityId+"/"+D,definition:{name:{"en-US":B}}},context:{contextActivities:{parent:tc_driver.courseActivityObject,grouping:tc_driver.courseActivityObject}},result:{}};if (C){E.result.completion=(TinCanCompStatus=='true');E.result.success=(A=='passed'||A=='completed'?true:false);E.result.score={"raw":parseInt(C,10),"min":0,"max":100};};TinCanSendStatement(tc_driver,E,function(){});return true;}
