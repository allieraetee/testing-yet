
		/*
 * Copyright (C) 2007 Trivantis Corporation
 */

	
var jTitleManager=new JSTitleMgr();function JSTitleMgr(){var A=this;A.arVars=[];A.arTests=[];A.bPerUpd=false;A.bIntActs=false;A.bCM=false;A.bIntTxt=false;A.bForceTF=true;A.bSCORM=false;A.bAICC=false;A.bTinCan=false;A.intCID=-1;A.intLID=-1;A.intSID=-1;A.intTIdx=-1;A.intQIdx=-1;A.cmVers=0;A.scVers=0;A.strAiccST='';A.strAiccEM='';A.strAiccSN='';A.strAiccCR='';A.strAiccCO='';A.strCmBase='';A.strRedir='';};var TMPr=JSTitleMgr.prototype;TMPr.setCoursemillParms=function(A,B,C,D){var E=this;E.strAiccST=''+A;E.strAiccSN=''+B;E.strAiccCO=''+C;E.strCmBase=''+D;if(E.bCM&&E.cmVers>=2) E.persistCMVars(false,B);};TMPr.persistCMVars=function(A,B){var C=true;var D=this;if(D.bCM&&(D.bPerUpd||!A)){var E=null;var F=D.findVariable("AICC_Lesson_Location");if(F<0){if(A||D.cmVers<2) return false;};if(D.cmVers>=2) E=D.strCmBase+"/persistvars.jsp";else{if(B=="AICC_Lesson_Location") E=D.strCmBase+"/bookmark.jsp?currpage="+D.arVars[F].vv;};if(E!=null){var G=new TrivStr("");var i;var H=new TrivStr("");if(A){if(D.cmVers>=2){G.addparm("put","yes");for(i=0;i<D.arVars.length;i++){if(D.arVars[i].bP) H.add(D.arVars[i].vn+'='+D.arVars[i].vv+'\r\n');};if(F>=0) G.addparm("loc",D.arVars[F].vv,true);G.addparm("vars",H.str,true);}}else G.addparm("get","yes");G.str=G.str.replace(/\+/g,'%2B');var I=getHTTP(E,D.cmVers>=2?'POST':'GET',G.str);if(I.status==200){var J=I.responseText;while(J.length>2&&J.indexOf('\r\n')==0) J=J.substring(2);var K;if(J.length>3) K=J.substring(0,3);else K=J;if(K=="200"){var L=J.indexOf('\r\n');K=J.substring(L+2);if(!A){var M;for(;L!=-1&&L<J.length;L=M){L+=2;M=J.indexOf('\r\n',L);var N=J.indexOf('=',L);if(N>=0){name=J.substring(L,N);value=J.substring(N+1,M);D.setVariable(name,value,"365");}}}}else if(K=="550"||(K=="500"&&D.cmVers<2)){C=false;trivAlert('CM_SUBVARSERR','CourseMill',trivstrCMTO);parent.document.location.href=readCookie('TrivantisBase','/');}}};if(A&&C) D.bPerUpd=false;};return C;};TMPr.setUserInfo=function(A,B){this.strAiccSN=A;this.strAiccEM=B;};TMPr.findVariable=function(A){var i;var B=A.toLowerCase();for(i=0;i<this.arVars.length;i++){var C=this.arVars[i].vn.toLowerCase();if(C==B) return i;};return-1;};TMPr.getVariable=function(A,B,C){var i=this.findVariable(A);if(i>=0) return this.arVars[i].vv;return this.addVariable(A,B,C);};TMPr.setVariable=function(A,B,C){var D=this;var i=D.findVariable(A);if(D.intTIdx!=-1) D.arTests[D.intTIdx].SetInteraction(A,D.intQIdx);if(i>=0){if(D.arVars[i].bP&&D.arVars[i].vv!=B) D.bPerUpd=true;D.arVars[i].vv=B;if(A=='cmi.core.student_name') D.strAiccSN=B;if(D.bCM) D.persistCMVars(true,A);return;};D.addVariable(A,B,C);};TMPr.addVariable=function(A,B,C){if(B==null) B="";var D=new TrivVar();D.vn=A;D.vv=B;if(C){D.bP=true;this.bPerUpd=true;};this.arVars.push(D);if(A=='cmi.core.student_name') this.strAiccSN=B;if(this.bCM) this.persistCMVars(true,A);return B;};TMPr.loadTest=function(A,B,C){var D=this;var E=D.getTIdx(B,1);if(E<0) return false;if(!D.arTests[E].bLoaded){var F=A+'.xml';var G=getHTTP(F,'GET',null);if(G.status!=200&&G.status!=0){trivAlert('LOADTESTERR',B,getLocStr(trivstrErrLoadTestServer,G.status,G.statusText));return;};var H=0;if ((!G.responseXML)||G.responseXML.documentElement===null||G.responseXML.getElementsByTagName("parsererror").length>0){if (is.ie10orLess&&G.responseXML.documentElement===null&&G.responseXML.getElementsByTagName("parsererror").length<1){var I=new ActiveXObject("Microsoft.XMLDOM");if (I){I.async="false";I.loadXML(G.responseText);H=I.documentElement;}}};var J=(H?H:G.responseXML.documentElement);if(!J&&window.ActiveXObject){J=new ActiveXObject("Microsoft.XMLDOM");J.async="false";J.load(F);if (!(J&&J.parseError&&J.parseError.errorCode==0)){J=null;}};if (!J){trivAlert('LOADTESTERR',B,getLocStr(trivstrErrLoadTestXml,A));return;};D.arTests[E].strLoadedName=B;D.arTests[E].loadTestFile(J);};D.intTIdx=-1;if(D.arTests[E].bLoaded&&D.bIntActs){D.intQIdx=D.arTests[E].StartInteractions(C);if(D.intQIdx!=-1) D.intTIdx=E;};return true;};TMPr.ResetTest=function(A){var B=this.getTIdx(A,true);if(B<0) return false;this.arTests[B].ResetTest();return true;};TMPr.getTIdx=function(A,B){var i;for(i=0;i<this.arTests.length;i++){if(this.arTests[i].strLoadedName==A) return i;};if(!B) return-1;var C=new TrivTest();this.arTests.push(C);return this.arTests.length-1;};TMPr.getRemainingTime=function(A){var B=this.getTIdx(A,false);var C=0;var D=0;if(B<0||!this.arTests[B].bLoaded) return null;if(this.arTests[B].lStartTime>0){var E=new Date().getTime();D=E-this.arTests[B].lStartTime;};C=parseInt((this.arTests[B].iTestTime*60000-D-this.arTests[B].lElapsedTime)/1000,10);if(C>0){var F;var G=parseInt(C/3600,10);C-=G*3600;F=G+':';G=parseInt(C/60,10);C-=G*60;if(G<=9) F+='0';F+=G+':';if(C<=9) F+='0';F+=C;return F;}else return null;};TMPr.startTestTimer=function(A){var B=this.getTIdx(A,false);if(B<0||!this.arTests[B].bLoaded) return;if(this.arTests[B].lStartTime==0) this.arTests[B].lStartTime=new Date().getTime();};TMPr.stopTestTimer=function(A){var B=this.getTIdx(A,false);if(B<0||!this.arTests[B].bLoaded) return;if(this.arTests[B].lStartTime>0){var C=new Date();this.arTests[B].lElapsedTime+=C.getTime()-this.arTests[B].lStartTime;this.arTests[B].lStartTime=0;}};TMPr.getRandomPageNumber=function(A,B){var C=this.getTIdx(A,false);if(C<0||!this.arTests[C].bLoaded) return "";return this.arTests[C].getRandomPageNumber(B);};TMPr.getRandomSectPageNumber=function(A,B,C){var D=this.getTIdx(A,false);if(D<0||!this.arTests[D].bLoaded) return "";return this.arTests[D].getRandomSectPageNumber(B,C);};TMPr.getPrevTestPage=function(A,B){var C=this.getTIdx(A,false);if(C<0||!this.arTests[C].bLoaded) return null;var D=this.arTests[C].getPrevTestPage(B);if(D!=null){if(D.indexOf('#')==0){var E=D.substring(1);C=this.getTIdx(E,false);if(C>=0&&this.arTests[C].bLoaded){var F=this.arTests[C].iNumPages-1;D=this.arTests[C].arRTPages[F].name;}};return D;}else return this.processTest(A);};TMPr.getNextTestPage=function(A,B){var C=this.getTIdx(A,false);if(C<0||!this.arTests[C].bLoaded) return null;var D=this.arTests[C].getNextTestPage(B);if(D!=null){if(D.indexOf('#')==0){var E=D.substring(1);D=this.getNextTestPage(E,"");};return D;}else return null;};TMPr.getRandomPage=function(A,B){var C=this.getTIdx(A,false);if(C<0||!this.arTests[C].bLoaded) return null;return this.arTests[C].getRandomPage(B);};TMPr.cancelTest=function(A){var B=this.getTIdx(A,false);if(B<0||!this.arTests[B].bLoaded) return null;var C=this.arTests[B].strFailPage;if(C.indexOf('#')==0){var D=C.substring(1);C=this.getNextTestPage(D,"");};return C;};TMPr.processTest=function(A){var B=this;var C=B.getTIdx(A,false);var D=B.arTests[C];if(C<0||!D.bLoaded) return null;strTestName=D.strTestName;D.GradeTest(B.arVars);D.strTestResult=D.ProcessTest(B.bCM,B.strCmBase,B.strAiccSN,B.strAiccST,B.strAiccEM,B.strAiccCO,B.arVars);if(D.strTestResult.indexOf('#')==0){var E=D.strTestResult.substring(1);D.strTestResult=B.getNextTestPage(E,"");};if(B.bIntActs){var F;var G;var H;if(B.bSCORM){if(B.intCID==-1) B.intCID=B.findVariable("cmi.core.course_id");if(B.intLID==-1) B.intLID=B.findVariable("cmi.core.lesson_id");if(B.intSID==-1) B.intSID=B.findVariable("cmi.core.student_id");}else{if(B.intCID==-1) B.intCID=B.findVariable("COURSE_ID");if(B.intLID==-1) B.intLID=B.findVariable("LESSON_ID");if(B.intSID==-1) B.intSID=B.findVariable("STUDENT_ID");};if(B.intCID!=-1) F=B.arVars[B.intCID].vv;else F=B.strAiccCO;if(B.intLID!=-1) G=B.arVars[B.intLID].vv;else G="";if(B.intSID!=-1) H=B.arVars[B.intSID].vv;else H="";var I=new TrivStr("");D.HandleInteractions(I,F,H,G,B.scVers,B.bIntTxt,B.bForceTF);if(B.bAICC) B.PutInteractions(I.str);};return D.strTestResult;};TMPr.getStudentResults=function(A){var i=this.getTIdx(A,false);return ((i<0||!this.arTests[i].bLoaded)?null:this.arTests[i].strStudentRes);};TMPr.getTestName=function(A){var i=this.getTIdx(A,false);return ((i<0||!this.arTests[i].bLoaded)?null:this.arTests[i].strTestName);};TMPr.getProcessTestResult=function(A){var i=this.getTIdx(A,false);return ((i<0||!this.arTests[i].bLoaded)?null:this.arTests[i].strTestResult);};TMPr.getProcessTestResponse=function(A){var B=this.getTIdx(A,false);if(B<0||!this.arTests[B].bLoaded) return null;return this.arTests[B].strTestSubmit;};TMPr.GetTestScore=function(A){var i=this.getTIdx(A,false);if(i<0) return "0";var B=this.arTests[i];if(!B.bLoaded) return "0";var C=B.GradeTest(this.arVars);if(!B.bAutoG||C>=B.iPassGrade||C==-1) B.strTestResult=B.strPassPage;else B.strTestResult=B.strFailPage;return C;};TMPr.GetIfTestPassed=function(A){var B=this.getTIdx(A,false);if(B<0||!this.arTests[B].bLoaded) return false;var C=this.arTests[B].GradeTest(this.arVars);if(!this.arTests[B].bAutoG||C>=this.arTests[B].iPassGrade||C==-1) return true;else return false;};TMPr.GetQuestionList=function(A){var B=this.getTIdx(A,false);if(B<0||!this.arTests[B].bLoaded) return "0";return this.arTests[B].getQuestionList();};TMPr.GetTestSectionScore=function(A,B){var C=this.getTIdx(A,false);if(C<0||!this.arTests[C].bLoaded) return "0";return this.arTests[C].GradeTestSection(this.arVars,B);};TMPr.getVariableNameAt=function(A){if(A>=0&&A<this.arVars.length) return this.arVars[A].vn;return "";};TMPr.getVariableValueAt=function (A){if(A>=0&&A<this.arVars.length) return this.arVars[A].vv;return "";};TMPr.getNumVariables=function(){return this.arVars.length;};TMPr.isWeb20Enabled=function(){return trivWeb20Popups;};function TrivVar(){this.bP=false;this.vn="";this.vv="";};function TrivStr(a){this.str=a;this.count=0;};p=TrivStr.prototype;p.add=function(a){this.str+=a;};p.getCount=function(){return this.count++;};p.addparm=function(A,B,C){if(this.str.length>0) this.str+="&";if(C) this.str+=A+"="+B;else this.str+=escape(A)+"="+escape(B);};function getNVStr(A,B,C){var D=A.getElementsByTagName(B)[0];if(D&&D.firstChild) return D.firstChild.data;else return C;};function getNVInt(A,B,C){if (!A) return C;var D=parseInt(getNVStr(A,B,C),10);return (isNaN(D)?C:D);};function get_random(A){var B=0;A+=2;while (B<1||B>A-1) B=Math.round(Math.random()*A);return (B-1);};function TrivTest(){var A=this;A.bLoaded=false;A.strLoadedName="";A.strTestName="";A.strResults="";A.bAutoG=0;A.iShowRes=0;A.bShowScOnly=0;A.iTestTime=0;A.iNumberRandom=0;A.iPassGrade=0;A.bModeGet=0;A.bIncVar=0;A.bPromptSuc=0;A.bPersist=0;A.iStudScore=0;A.lStartTime=0;A.lElapsedTime=0;A.strFailPage="";A.strPassPage="";A.strPrevPage="";A.strAllowedTM="";A.strElapsedTM="";A.strTestSubmit="";A.bSurvey=0;A.arRTPages=[];A.strStudentRes="";A.bGDocs=0;A.bIsNewGDocURL=false;};var TTPr=TrivTest.prototype;TTPr.loadTestFile=function(A){var B=this;B.bSurvey=getNVInt(A,'survey',B.bSurvey);B.bAutoG=getNVInt(A,'grade',B.bAutoG);B.iShowRes=getNVInt(A,'showresults',B.iShowRes);B.bShowScOnly=getNVInt(A,'scoreonly',B.bShowScOnly);B.bModeGet=getNVInt(A,'get',B.bModeGet);B.bIncVar=getNVInt(A,'incvar',B.bIncVar);B.bPromptSuc=getNVInt(A,'promptsuccess',B.bPromptSuc);B.bPersist=getNVInt(A,'persist',B.bPersist);B.strTestName=getNVStr(A,'name',B.strTestName);B.strResults=getNVStr(A,'submitto',B.strResults);B.iTestTime=getNVInt(A,'testtime',B.iTestTime);B.iNumberRandom=getNVInt(A,'numrandom',B.iNumberRandom);B.iPassGrade=getNVInt(A,'passinggrade',B.iPassGrade);B.strFailPage=getNVStr(A,'cancelfail',B.strFailPage);B.strPassPage=getNVStr(A,'passdone',B.strPassPage);B.strPrevPage=getNVStr(A,'prevpage',B.strPrevPage);B.bGDocs=getNVInt(A,'gdocs',B.bGDocs);B.testNode=A;B.LoadPages();B.bLoaded=true;};TTPr.LoadPages=function(){var A=this,i,B,C,D=[],E=A.testNode;if (E.childNodes&&E.childNodes.length) for (i=0;i<E.childNodes.length;i++){var F=E.childNodes[i],G=F.tagName?F.tagName.toLowerCase():'none';if (G=='page'){B=new TrivTestPage();B.load(-1,F);D.push(B);}else if (G=='section'){C=new TrivTestSection();C.load(F);C.LoadPages(D,(A.iNumberRandom>0)?false:true);}};if (A.iNumberRandom>0){if (A.iNumberRandom>D.length) A.iNumberRandom=D.length;while (A.iNumberRandom>A.arRTPages.length){var H=get_random(D.length-1);A.arRTPages.push(D.splice(H,1)[0]);}}else A.arRTPages=D;};TTPr.ResetTest=function(){this.arRTPages.length=0;this.LoadPages();this.lElapsedTime=0;};TTPr.GetTestScore=function(A){var B=0;var C=0;var D=0;var E=0;var F=true;for(var G=0;G<this.arRTPages.length;G++){this.arRTPages[G].gradeQs(A);if(!this.arRTPages[G].isScoreable()) F=false;D=this.arRTPages[G].getMaxScore();E=this.arRTPages[G].getScore();B+=D;C+=E;};if(F){if(B>0) this.iStudScore=parseInt(C*100.0/B+0.5,10);else this.iStudScore=100;}else this.iStudScore=-1;return this.iStudScore;};TTPr.getQuestionList=function(){var A='';for(var B=0;B<this.arRTPages.length;B++){var C=this.arRTPages[B].getQuestionList();if(C.length!=0) A+=C;};return A;};TTPr.GradeTest=function(A) { return this.GetTestScore(A);};TTPr.GradeTestSection=function(A,B){var C=0;var D=0;var E=0;var F=0;var G=0;var H=true;for(var I=0;I<this.arRTPages.length;I++){if(this.arRTPages[I].iSectionId==B){this.arRTPages[I].gradeQs(A);if(!this.arRTPages[I].isScoreable()) H=false;E=this.arRTPages[I].getMaxScore();F=this.arRTPages[I].getScore();C+=E;D+=F;}};if(H){if(C>0) G=parseInt(D*100/C,10);else G=100;}else G=-1;return G;};TTPr.ProcessTest=function(A,B,C,D,E,F,G){var H=this;var I=null;var J=true;var K,L,M,N;if(H.iTestTime>0){K=H.iTestTime*60;L=parseInt(K/3600,10);K-=(L*3600);H.strAllowedTM="";if(L<10) H.strAllowedTM+="0";H.strAllowedTM+=L+":";L=parseInt(K/60,10);K-=(L*60);if(L<10) H.strAllowedTM+="0";H.strAllowedTM+=L+":";if(K<10) H.strAllowedTM+="0";H.strAllowedTM+=K;M=parseInt(H.lElapsedTime/1000,10);if(M>H.iTestTime*60||M<0) M=H.iTestTime*60;L=parseInt(M/3600,10);M=M-(L*3600);H.strElapsedTM="";if(L<10) H.strElapsedTM+="0";H.strElapsedTM+=L+":";L=parseInt(M/60,10);M-=(L*60);if(L<10) H.strElapsedTM+="0";H.strElapsedTM+=L+":";if(M<10) H.strElapsedTM+="0";H.strElapsedTM+=M;};window.resWind=null;if (H.iShowRes){H.strStudentRes=H.CreateTextResults(C,G);};if (A){var O=B+"/testresults.jsp";N=new TrivStr("");if(C) N.addparm("user",C);if(F) N.addparm("course",F);H.CreateCGIResults(N,G,true,false);N.str=N.str.replace(/\+/g,'%2B');var P=getHTTP(O,'POST',N.str);if(P.status==200){var Q=P.responseText;while(Q.length>2&&Q.indexOf('\r\n')==0){var R=Q.substring(2);Q=R;};var S;if(Q.length>3) S=Q.substring(0,3);else S=Q;var T="";if(S=="520"){J=false;T=trivstrERRNQ;}else if(S=="530"){J=false;T=trivstrERRAS;}else if(S=="430"){J=false;T=trivstrERRLI;}else if(S!="200"){J=false;T=trivstrERRST;};if(!J){trivAlert('CM_HTTPERR',H.strLoadedName,T);}}};I=H.getVariableMacroValue(H.strResults,G);H.bIsNewGDocURL=H.bGDocs&&parseKeyFromGDocURL(I)==n;if(J&&I&&I.toLowerCase()!="null"&&I.length>0){N=new TrivStr("");if(H.bGDocs){if (C) if (H.bIsNewGDocURL) N.addparm('entry_1'+padDigits(N.getCount(),6),C);else{var U=parseKeyFromGDocURL(H.strResults);if (U) N.addparm(U[0],U[1]);N.addparm('entry.'+N.getCount()+'.single',C);}}else N.addparm("name",C);H.CreateCGIResults(N,G,false);N.str=N.str.replace(/\+/g,'%2B');var P=null;if (H.bGDocs){I=H.bIsNewGDocURL?I:"https://spreadsheets.google.com/formResponse";if(is.ie&&!H.bIsNewGDocURL){var X=I+'?'+N.str;var Y=document.getElementsByTagName("head").item(0);var Z=document.createElement("script");Z.setAttribute("type","text/javascript");Z.setAttribute("src",X);Y.appendChild(Z);}else P=getHTTP(I,(H.bIsNewGDocURL?'POST':'GET'),N.str);J=true;}else{P=getHTTP(I,'POST',N.str);J=(P.status==200);H.strTestSubmit=P.responseText;};if(J&&H.bPromptSuc){var a=(!H.bSurvey?trivstrTRSUB:trivstrSUSUB);if(!trivWeb20Popups||true){if(window.resWind!=null) window.resWind.alert(a);else alert(a);}else trivAlert('SUBERR',H.strLoadedName,a);}};if(!H.bAutoG||H.iStudScore>=H.iPassGrade||H.iStudScore==-1) return H.strPassPage;else return H.strFailPage;};TTPr.CreateTextResults=function(A,B){var C;var D=0;var E=new TrivStr("");var F=function (G){return  G.charAt(G.length-1)==" "?G:G+=" ";};E.add(this.strTestName+"<br /><br />");if(A!=null&&A.length>0) E.add(F(trivstrSTUD)+A+"<br /><br />");if(this.iStudScore!=-1&&this.bAutoG){E.add(F(trivstrSCORE)+this.iStudScore+"%<br />");if(this.iStudScore>=this.iPassGrade) E.add(trivstrPASS);else E.add(trivstrFAIL);E.add("<br /><br />");};if(this.bShowScOnly==0){for(C=0;C<this.arRTPages.length;C++) D=this.arRTPages[C].createTextResults(E,D,this.bAutoG);};return E.str;};TTPr.CreateCGIResults=function(A,B,C,D){var E=this;var F;var G=0;var H=-1;var I=0;var J=0;var K=0;var L=0;var M=0;var N=0;var O=0;var P=0;var Q=0;var R=0;var S=0;var T=0;if(D==undefined) D=E.bGDocs;if(!D) A.addparm(E.bSurvey?"SurveyName":"TestName",E.strTestName);for(F=0;F<E.arRTPages.length;F++){G=E.arRTPages[F].createCGIResults(A,G,D,E.bIsNewGDocURL);if(H!=E.arRTPages[F].iSectionId){if(H>0&&E.bAutoG){var U="TrueFalseSection"+H;var W=P+"/"+J;if(!D) A.addparm(U,W);U="MultipleChoiceSection"+H;W=S+"/"+M;if(!D) A.addparm(U,W);};P=0;S=0;J=0;M=0;H=E.arRTPages[F].iSectionId;};K=E.arRTPages[F].getNumTFQs();Q=E.arRTPages[F].getNumCorrectTFQs();N=E.arRTPages[F].getNumMCQs();T=E.arRTPages[F].getNumCorrectMCQs();I+=K;J+=K;O+=Q;P+=Q;L+=N;M+=N;R+=T;S+=T;};if(!E.bShowScOnly&&H>0&&E.bAutoG){var U="TrueFalseSection"+H;var W=P+"/"+J;if(!D) A.addparm(U,W);U="MultipleChoiceSection"+H;W=S+"/"+M;if(!D) A.addparm(U,W);};if(E.iStudScore!=-1&&E.bAutoG){if(D) if (E.bIsNewGDocURL) A.addparm('entry_1'+padDigits(A.getCount(),6),E.iStudScore);else A.addparm('entry.'+A.getCount()+'.single',E.iStudScore);else A.addparm("Score",E.iStudScore);}else if(C) A.addparm("Score","-1");if(E.bAutoG||C){if(!D) A.addparm("PassingGrade",E.iPassGrade);if(!D) A.addparm("TrueFalse",O+"/"+I);if(!D) A.addparm("MultipleChoice",R+"/"+L);};A.addparm("NumQuestions",G);if(E.strAllowedTM!=""){if(!D) A.addparm("AllowedTime",E.strAllowedTM);if(!D) A.addparm("ElapsedTestTime",E.strElapsedTM);};if(E.bIncVar&&!D){for(F=0;F<B.length;F++) {if ((submitValue=E.getVariableSubmitValue(F,B))=="~~~null~~~") submitValue=trivstrNA;A.addparm(E.getVariableSubmitName(F,B),submitValue,true);}};return true;};TTPr.getRandomPageNumber=function(A){var i;for(i=0;i<this.arRTPages.length;i++) if(this.arRTPages[i]&&this.arRTPages[i].name==A) return String(i+1);return "";};TTPr.getRandomSectPageNumber=function(A,B){var i;var C=0;for(i=0;i<this.arRTPages.length;i++){if(this.arRTPages[i].iSectionId==A) C++;if(this.arRTPages[i].name==B) return String(C);};return "";};TTPr.findTestPage=function(A){var i;for(i=0;i<this.arRTPages.length;i++) if(this.arRTPages[i].name==A) return i;return-1;};TTPr.getPrevTestPage=function(A){var B=this.findTestPage(A);if(B>0) B--;else if(B==0) return this.strPrevPage;else B=this.arRTPages.length-1;if(B>=0&&B<this.arRTPages.length) return this.arRTPages[B].name;return null;};TTPr.getNextTestPage=function(A){var B=this.findTestPage(A);if(B>-1&&B<this.arRTPages.length) B++;else B=0;if(B>=0&&B<this.arRTPages.length) return this.arRTPages[B].name;return null;};TTPr.getRandomPage=function(A){var i;var B=0;if(A) B=A.length;for(i=0;i<this.arRTPages.length;i++){var C=this.arRTPages[i].name.substr(0,B);if(C==A) return this.arRTPages[i].name;};return null;};TTPr.getVariableSubmitName=function(A,B){if(B[A].vn.length>3){var C=B[A].vn.substring(0,3).toLowerCase();if(C=="var") return B[A].vn.substring(3);};return B[A].vn;};TTPr.getVariableSubmitValue=function(A,B){if(B[A].vv.length>7){var C=B[A].vv.substring(0,7);if(C=="~~f=1~~"||C=="~~f=2~~"||C=="~~f=4~~"){var D=B[A].vv.indexOf('|');return B[A].vv.substring(D+1);}}else if (B[A].vv=="~~~null~~~") return "";return B[A].vv;};TTPr.getVariableMacroValue=function(A,B){var C=A;var D=A.length;if(D>6){var E;var F;var G;E=A.substring(0,4).toLowerCase();F=A.substring(4,D-1);G=A.substring(D-1);if(E=="var("&&G==")"){var H;for(H=0;H<B.length;H++){if(B[H].vn==F) return this.getVariableSubmitValue(H,B);}}};return C;};function TrivTestSection(){var A=this;A.iNumberRandom=0;A.iSectionId=-1;A.index=-1;A.arPages=[];};var TSPr=TrivTestSection.prototype;TSPr.load=function(A){this.iSectionId=getNVInt(A,'id',this.iSectionId);this.iNumberRandom=getNVInt(A,'numrandom',this.iNumberRandom);this.index=getNVInt(A,'index',this.index);var B=A.getElementsByTagName('page');if (B) for(var i=0;i<B.length;i++){var C=new TrivTestPage();C.load(this.iSectionId,B[i]);this.arPages.push(C);}};TSPr.LoadPages=function(A,B){var C=this,D=[],i,E;if(C.iNumberRandom>0&&B){for(i=0;i<C.arPages.length;i++) D.push(C.arPages[i]);if (C.iNumberRandom>D.length) C.iNumberRandom=D.length;E=D.length;while (E-D.length<C.iNumberRandom){var F=get_random(D.length-1);A.push(D.splice(F,1)[0]);}}else{for(i=0;i<C.arPages.length;i++) A.push(C.arPages[i]);}};function TrivTestPage(){this.index=-1;this.name="";this.iSectionId=-1;this.arQues=[];};var TPPr=TrivTestPage.prototype;TPPr.load=function(A,B){var C=this;C.iSectionId=A;C.index=getNVInt(B,'index',C.index);C.name=getNVStr(B,'name',C.name);var D=B.getElementsByTagName('question');if (D) for(var i=0;i<D.length;i++){var E=new TrivQuestion();E.load(C.iSectionId,D[i]);C.arQues.push(E);}};TPPr.gradeQs=function(A){for(var B=0;B<this.arQues.length;B++) this.arQues[B].gradeQs(A);};TPPr.getQuestionList=function(){var A=this;var B='';for(var C=0;C<A.arQues.length;C++){if((A.arQues[C].type==7||A.arQues[C].type==6)&&A.arQues[C].bGradeInd){var D;for(D=0;D<A.arQues[C].arCorrAns.length;D++) B+=A.arQues[C].id+'-'+(D+1)+';';}else if((A.arQues[C].type==2||A.arQues[C].type==14||A.arQues[C].type==9||A.arQues[C].type==11)&&A.arQues[C].bGradeInd){var D;for(D=0;D<A.arQues[C].arChoices.length;D++) B+=A.arQues[C].id+'-'+(D+1)+';';}else B+=A.arQues[C].id+';';};return B;};TPPr.getNumTFQs=function(){var A=0;for(var B=0;B<this.arQues.length;B++) A+=this.arQues[B].getNumTFQs();return A;};TPPr.getNumCorrectTFQs=function(){var A;var B=0;for(A=0;A<this.arQues.length;A++) B+=this.arQues[A].getNumCorrectTFQs();return B;};TPPr.getNumMCQs=function(){var A;var B=0;for(A=0;A<this.arQues.length;A++) B+=this.arQues[A].getNumMCQs();return B;};TPPr.getNumCorrectMCQs=function(){var A;var B=0;for(A=0;A<this.arQues.length;A++) B+=this.arQues[A].getNumCorrectMCQs();return B;};TPPr.createTextResults=function(A,B,C){for(var D=0;D<this.arQues.length;D++) B=this.arQues[D].createTextResults(A,B,C);return B;};TPPr.getMaxScore=function(){var A=0;for(var B=0;B<this.arQues.length;B++) A+=this.arQues[B].getMaxScore();return A;};TPPr.getScore=function(){var A=0;for(var B=0;B<this.arQues.length;B++) A+=this.arQues[B].getScore();return A;};TPPr.isScoreable=function(){for(var A=0;A<this.arQues.length;A++) if(!this.arQues[A].isScoreable()) return false;return true;};TPPr.createCGIResults=function(A,B,C,D){for(var E=0;E<this.arQues.length;E++) B=this.arQues[E].createCGIResults(A,B,C,D);return B;};function TrivQuestion(){var A=this;A.id=0;A.iSectionId=-1;A.type=0;A.weight=1;A.name="";A.varName="";A.text="";A.corrAns="";A.arCorrAns=[];A.arChoices=[];A.arAddedInfo=[];A.arRel=[];A.arStatements=[];A.choices="";A.bAllowMult=0;A.bPersist=0;A.bGradeInd=0;A.bSurvey=0;A.strOurAns="";A.iOurScore=0;};var TQPr=TrivQuestion.prototype;TQPr.load=function(A,B){var C=this,D;C.iSectionId=A;C.id=getNVInt(B,'id',C.id);C.type=getNVInt(B,'type',C.type);C.weight=getNVInt(B,'weight',C.weight);C.name=getNVStr(B,'name',C.name);C.varName=getNVStr(B,'var',C.varName);D=getNVStr(B,'text',C.text);C.corrAns=unescape(getNVStr(B,'correctans',C.corrAns));C.bAnyAnswer=getNVInt(B,'anyanswer',this.bAnyAnswer);C.bCaseSensitive=getNVInt(B,'casesensitive',this.bCaseSensitive);C.separator=getNVStr(B,'separator',this.separator);D=D.replace(/\r\n/g,'<br>');D=D.replace(/\n/g,'<br>');D=D.replace(/\r/g,'<br>');C.text=D;if (C.type==7||C.type==6||C.type==2||C.type==9||C.type==14||C.type==11){var E=0;var F;F=C.corrAns.indexOf(',');while(F!=-1){C.arCorrAns.push(C.corrAns.substring(E,F));E=F+1;F=C.corrAns.indexOf(',',E);};C.arCorrAns.push(C.corrAns.substring(E,C.corrAns.length));};if (C.type==5){var E=0;var F=C.corrAns.indexOf('|');while (F!=-1){C.arCorrAns.push(C.corrAns.substring(E,F));E=F+1;F=C.corrAns.indexOf('|',E);};C.arCorrAns.push(C.corrAns.substring(E,C.corrAns.length));};if (C.type==13){var I=getNVStr(B,'relationship',I);var E=0;var F=I.indexOf('|');while (F!=-1){C.arRel.push(I.substring(E,F));E=F+1;F=I.indexOf('|',E);};C.arRel.push(I.substring(E,I.length));E=0;var L=C.separator.length;F=C.corrAns.indexOf(C.separator);while (F!=-1){C.arCorrAns.push(C.corrAns.substring(E,F));E=F+L;F=C.corrAns.indexOf(C.separator,E);};C.arCorrAns.push(C.corrAns.substring(E,C.corrAns.length));};C.choices=unescape(getNVStr(B,'choices',C.choices));if (C.type==2||C.type==9||C.type==14||C.type==7||C.type==6||C.choices.indexOf('|')>=0){var E=0;var F=C.choices.indexOf('|');while (F!=-1){C.arChoices.push(C.choices.substring(E,F));E=F+1;F=C.choices.indexOf('|',E);};C.arChoices.push(C.choices.substring(E,C.choices.length));};var O=getNVStr(B,'addedinfo',null);if(O){var E=0;var F=O.indexOf('|');while (F!=-1){C.arAddedInfo.push(O.substring(E,F));E=F+1;F=O.indexOf('|',E);};C.arAddedInfo.push(O.substring(E,O.length));};var R=getNVStr(B,'statements',null);if(R){var E=0;var F=R.indexOf('|');while (F!=-1){C.arStatements.push(R.substring(E,F));E=F+1;F=R.indexOf('|',E);};C.arStatements.push(R.substring(E,R.length));};C.bAllowMult=getNVInt(B,'allowmult',C.bllowMult);C.bPersist=getNVInt(B,'persist',C.bPersist);C.bGradeInd=getNVInt(B,'gradeindividual',C.bGradeInd);C.bSurvey=getNVInt(B,'surveyquestion',C.bSurvey);};TQPr.getMaxScore=function(){var A=this;var B=0;if(!A.bSurvey){if(A.bGradeInd){if (A.type==14||A.type==9) B=A.arChoices.length;else if(A.arCorrAns.length>0) B=this.arCorrAns.length;else{B=1;for(var C=A.corrAns.indexOf(',');C!=-1;C=A.corrAns.indexOf(',',C+1)) B++;};B*=A.weight;}else if(A.type!=-1) B=A.weight;};return B;};TQPr.getScore=function(){var A=0;if(!this.bSurvey){if(this.type!=-1) A=this.iOurScore;};return A;};TQPr.isScoreable=function(){if(!this.bSurvey){if(this.type==3||this.type==4){if(this.weight>0) return false;}};return true;};TQPr.isCorrect=function(){var A=this;if(!A.bSurvey){if(A.strOurAns==null||A.strOurAns.length==0) return 0;switch(A.type){case 1:if(A.strOurAns!=null&&A.strOurAns==A.corrAns) return 1;break;case 2:case 9:case 14:case 11:if(A.strOurAns!=null&&A.bGradeInd){var B,C;var D=0;for(var i=0;i<this.arChoices.length;i++){var E=this.arChoices[i].replace(/,/g,"&#44");if(this.type==11){var F={i:-1};B=IsChoiceSelected(E,this.strOurAns,F);if(this.isCorrectSub(E,F)>0) C=true;else C=false;if((C&&B)) D++;}else{B=IsChoiceSelected(E,this.strOurAns);if(this.isCorrectSub(E)>0) C=true;else C=false;if((C&&B)||(!C&&!B)) D++;}};return D;}else if(A.strOurAns!=null&&A.strOurAns==A.corrAns) return 1;break;case 3:case 4:return 0;case 5:var G;var H;var I=0;if (!A.bCaseSensitive) H=A.strOurAns.toString().toLowerCase();else H=this.strOurAns.toString();for (var i=0;i<A.arCorrAns.length;i++) {if (!A.bCaseSensitive) G=A.arCorrAns[i].toLowerCase();else G=A.arCorrAns[i];if (A.bAnyAnswer) { if (H==G) return 1;}else { if (H.indexOf(G)==-1) return 0;else I=1;}};return I;case 13:var H=parseFloat(A.strOurAns.replace(/,/g,''));var I=0;var y=0;for (var i=0;i<A.arRel.length;i++){var L=false;switch (parseInt(A.arRel[i])){case 1:L=(H==parseFloat(A.arCorrAns[y].replace(/,/g,'')));break;case 2:L=(H>=parseFloat(A.arCorrAns[y].replace(/,/g,''))&&H<=parseFloat(A.arCorrAns[y+1].replace(/,/g,'')));y++;break;case 3:L=(H>parseFloat(A.arCorrAns[y].replace(/,/g,''))&&H<parseFloat(A.arCorrAns[y+1].replace(/,/g,'')));y++;break;case 4:L=(H>parseFloat(A.arCorrAns[y].replace(/,/g,'')));break;case 5:L=(H>=parseFloat(A.arCorrAns[y].replace(/,/g,'')));break;case 6:L=(H<parseFloat(A.arCorrAns[y].replace(/,/g,'')));break;case 7:L=(H<=parseFloat(A.arCorrAns[y].replace(/,/g,'')));break;case 8:L=(H!=parseFloat(A.arCorrAns[y].replace(/,/g,'')));break;};y++;if ((A.bAnyAnswer&&L)||(!A.bAnyAnswer&&!L)) return L;I=L;};return I;case 6:var M=A.strOurAns+',';var N;var D=0;for(var i=0;i<A.arCorrAns.length;i++){N=A.arCorrAns[i]+',';if(M.indexOf(N)!=-1) D+=1;else{if(!A.bGradeInd) return 0;}};if(A.bGradeInd) return D;else return 1;break;case 7:var M=A.strOurAns+',';var N;var D=0;for(var i=0;i<A.arCorrAns.length;i++){N=A.arCorrAns[i];var S=N.split('|');var T=false;for(var j=0;j<S.length&&!T;j++){var U=S[j];if(M.indexOf(U)!=-1) T=true;};if(T) D+=1;else{if(!A.bGradeInd) return 0;}};if(A.bGradeInd) return D;else return 1;break;case 8:return 1;}};return 0;};function GetMatchingPairStr(A,B){var C=",";var D=",";var E="";var F;var G;D+=B+",";C+=A+"-";F=D.indexOf(C);if(F<0) return E;G=D.indexOf(",",F+1);E=D.substring(F+1,G);return E;};function IsChoiceSelected(A,B,C){var D=B.split(',');var i;for(i=0;i<D.length;i++){if(D[i]==A) break;};if(C){if(i<D.length) C.i=i;else C.i=-1;};if(i>=D.length) return false;return true;};TQPr.isCorrectSub=function(A,B){if(!this.bSurvey){if(A!=null&&A.length>0){for(var i=0;i<this.arCorrAns.length;i++){if(A==this.arCorrAns[i]){if(B){B.correcti=i;if(B.i==i) return 1;else return 0;}else return 1;}}}};return 0;};TQPr.getNumTFQs=function(){if(!this.bSurvey){if(this.type==1) return this.weight;};return 0;};TQPr.getNumCorrectTFQs=function(){if(!this.bSurvey){if(this.type==1) return this.isCorrect()*this.weight;};return 0;};TQPr.getNumMCQs=function(){var A=0;if(!this.bSurvey){switch(this.type){case 2:case 5:case 9:case 13:case 14:case 7:case 6:A=1;if(this.bGradeInd) A=this.arChoices.length;break;};A*=this.weight;};return A;};TQPr.getNumCorrectMCQs=function(){var A=0;if(!this.bSurvey){switch(this.type){case 2:case 5:case 9:case 7:case 6:case 13:case 14:A=this.isCorrect();break;};A*=this.weight;};return A;};TQPr.gradeQs=function(A){var B=this;var C;B.strOurAns=null;B.iOurScore=0;if(B.type!=-1){for(C=0;C<A.length;C++){if(A[C].vn==B.varName){B.strOurAns=A[C].vv;break;}};if(!B.bSurvey){B.iOurScore=B.isCorrect();B.iOurScore*=B.weight;}}};TQPr.createTextResults=function(A,B,C){var D=this;var E;var F;var G=function (M){return  M.charAt(M.length-1)==" "?M:M+=" ";};if(D.type!=-1){B++;A.add(trivstrQ+B+"<br />"+D.text+"<br />");switch(D.type){case 1:case 2:case 9:case 10:case 11:case 12:case 14:if(C&&!D.bSurvey){if(D.bGradeInd){var H;var I;for(E=0;E<D.arChoices.length;E++){I=D.arChoices[E];if(D.type==11){var J={ i:-1,correcti:-1};H=IsChoiceSelected(I.replace(/,/g,"&#44"),D.strOurAns,J);if (D.isCorrectSub(I.replace(/,/g,"&#44"),J)>0){A.add(trivstrYAC+I+"="+(J.i+1).toString()+"<br />");}else{A.add(trivstrYA);if (!H) A.add(trivstrNA);else A.add(I+"="+(J.i+1).toString());A.add("<br />"+trivstrCA+(J.correcti+1).toString()+"<br />");}}else{H=IsChoiceSelected(I.replace(/,/g,"&#44"),D.strOurAns);if (D.isCorrectSub(I.replace(/,/g,"&#44"))>0){if(H) A.add(G(trivstrYACS)+I+"<br />");else A.add(G(trivstrYAINS)+I+"<br />");}else{if(H) A.add(G(trivstrYAIS)+I+"<br />");else A.add(G(trivstrYACNS)+I+"<br />");}};if(E<D.arChoices.length-1){B++;A.add("<br />"+trivstrQ+B+"<br />"+D.text+"<br />");}}}else{if(D.isCorrect()>0) A.add(G(trivstrYAC)+D.strOurAns+"<br />");else{A.add(G(trivstrYA));if(D.strOurAns==null||D.strOurAns.length==0||D.strOurAns=="~~~null~~~") A.add(trivstrNA);else A.add(D.strOurAns);A.add("<br />"+G(trivstrCA)+D.corrAns+"<br />");}}}else{A.add(G(trivstrYA));if(D.strOurAns==null||D.strOurAns.length==0||D.strOurAns=="~~~null~~~") A.add(trivstrNA);else A.add(D.strOurAns);A.add("<br />");};break;case 5:if (C&&!D.bSurvey) {if (D.isCorrect()>0) A.add(G(trivstrYAC)+D.strOurAns+"<br />");else{var K;if(D.bAnyAnswer) K=" "+trivstrOr+" ";else K=" "+trivstrAnd+" ";F=D.corrAns.replace(/\|/g,K);A.add(G(trivstrYA));if (D.strOurAns==null||D.strOurAns.length==0||D.strOurAns=="~~~null~~~") A.add(trivstrNA);else A.add(D.strOurAns);A.add("<br />"+G(trivstrCA)+F+"<br />");}}else {A.add(G(trivstrYA));if (D.strOurAns==null||D.strOurAns.length==0||D.strOurAns=="~~~null~~~") A.add(trivstrNA);else A.add(D.strOurAns);A.add("<br />");};break;case 13:if (C&&!D.bSurvey) {if (D.isCorrect()>0) A.add(G(trivstrYAC)+D.strOurAns+"<br />");else {F=D.getNEResult();A.add(G(trivstrYA));if (D.strOurAns==null||D.strOurAns.length==0||D.strOurAns=="~~~null~~~") A.add(trivstrNA);else A.add(D.strOurAns);A.add("<br />"+G(trivstrCA)+F+"<br />");}}else {A.add(G(trivstrYA));if (D.strOurAns==null||D.strOurAns.length==0||D.strOurAns=="~~~null~~~") A.add(trivstrNA);else A.add(D.strOurAns);A.add("<br />");};break;case 4:case 3:A.add(G(trivstrYA));if(D.strOurAns==null||D.strOurAns.length==0||D.strOurAns=="~~~null~~~") A.add(trivstrNA);else A.add(D.strOurAns);A.add("<br />");break;case 7:case 6:if(C){var L;if(D.bGradeInd){for(E=0;E<D.arCorrAns.length;E++){L=D.arCorrAns[E].substring(0,D.arCorrAns[E].indexOf('-'));F=GetMatchingPairStr(L,D.strOurAns);if(D.isCorrectSub(F)>0) A.add(G(trivstrYAC)+F+"<br />");else{A.add(G(trivstrYA));if(F==null||F.length==0) A.add(trivstrNA);else A.add(F);A.add("<br />"+G(trivstrCA)+D.arCorrAns[E]+"<br />");};if(E<D.arCorrAns.length-1){B++;A.add("<br />"+G(trivstrQ)+B+"<br />"+D.text+"<br />");}}}else{if(D.isCorrect()>0) A.add(G(trivstrYAC)+D.corrAns+"<br />");else{A.add(G(G(trivstrYA)));if(D.strOurAns==null||D.strOurAns.length==0||D.strOurAns=="~~~null~~~") A.add(trivstrNA);else{for(E=0;E<D.arCorrAns.length;E++){L=D.arCorrAns[E].substring(0,D.arCorrAns[E].indexOf('-'));F=GetMatchingPairStr(L,D.strOurAns);if(F==null||F.length==0) A.add(trivstrNA);else A.add(F);if(E<D.arCorrAns.length-1) A.add(",");}};A.add("<br />"+G(trivstrCA)+D.corrAns+"<br />");}}}else{if(D.bGradeInd){for(E=0;E<D.arCorrAns.length;E++){L=D.arCorrAns[E].substring(0,D.arCorrAns[E].indexOf('-'));F=GetMatchingPairStr(L,D.strOurAns);A.add(G(trivstrYA));if(F==null||F.length==0) A.add(trivstrNA);else A.add(F);A.add("<br />");if(E<D.arCorrAns.length-1){B++;A.add("<br />"+G(trivstrQ)+B+"<br />"+D.text+"<br />");}}}else{A.add(G(trivstrYA));if(D.strOurAns==null||D.strOurAns.length==0||D.strOurAns=="~~~null~~~") A.add(trivstrNA);else{for(E=0;E<D.arCorrAns.length;E++){L=D.arCorrAns[E].substring(0,D.arCorrAns[E].indexOf('-'));F=GetMatchingPairStr(L,D.strOurAns);if(F==null||F.length==0) A.add(trivstrNA);else A.add(F);if(E<D.arCorrAns.length-1) A.add(",");}};A.add("<br />"+G(trivstrCA)+D.corrAns+"<br />");}};break;};A.add("<br />");};return B;};TQPr.createCGIResults=function(A,B,C,D){var E=this,F,G,H,I="",J="",K="",L="",M="",N="",O="",P="",Q;if(C==undefined) C=false;if(D==undefined) D=false;B++;Q=B;I="Question"+Q;J="Answer"+Q;K="CorrectAnswer"+Q;L="QuestionType"+Q;M="QuestionID"+Q;N="Section"+Q;if(!C) A.addparm(L,E.type);if(!C) A.addparm(M,E.id);if(this.iSectionId>0&&!C) A.addparm(N,E.iSectionId);switch(E.type){case 1:case 2:case 9:case 11:case 12:case 14:if(!C) A.addparm(I,E.text);if(E.bGradeInd){for(F=0;F<E.arChoices.length;F++){if(E.strOurAns==null||E.strOurAns.length==0||E.strOurAns=="~~~null~~~") H=trivstrNA;else{if(IsChoiceSelected(E.arChoices[F],E.strOurAns)) H=E.arChoices[F];else H=trivstrNA+', '+E.arChoices[F];};if(C) if (D) A.addparm('entry_1'+padDigits(A.getCount(),6),H);else A.addparm('entry.'+A.getCount()+'.single',H);else A.addparm(J,H);if(!C) A.addparm(K,E.corrAns);if(F<E.arChoices.length-1){B++;Q=B;I="Q"+Q;J="Answer"+Q;K="CorrectAnswer"+Q;L="QuestionType"+Q;M="QuestionID"+Q;N="Section"+Q;if(!C) A.addparm(I,E.text);if(!C) A.addparm(L,E.type);if(!C) A.addparm(M,E.id);if(E.iSectionId>0&&!C) A.addparm(N,E.iSectionId);}}}else{if(E.strOurAns==null||E.strOurAns.length==0||E.strOurAns=="~~~null~~~") H=trivstrNA;else H=E.strOurAns;if(C) if (D) A.addparm('entry_1'+padDigits(A.getCount(),6),H);else A.addparm('entry.'+A.getCount()+'.single',H);else A.addparm(J,H);if(!E.bSurvey&&!C) A.addparm(K,E.corrAns);};break;case 10:if(E.strOurAns==null||E.strOurAns.length==0||E.strOurAns=="~~~null~~~") H=trivstrNA;else H=E.strOurAns;var R=0;for(var i=0;i<E.arAddedInfo.length;i++){for(var j=0;j<E.arChoices.length;j++){var S=E.arAddedInfo[i]+'-'+E.arChoices[j];if (H.indexOf(S)>-1){if (R>0){B++;Q=B;I="Question"+Q;J="Answer"+Q;L="QuestionType"+Q;M="QuestionID"+Q;N="Section"+Q;if(!C) A.addparm(L,E.type);if(!C) A.addparm(M,E.id);if(this.iSectionId>0&&!C) A.addparm(N,E.iSectionId);};O="Instructions"+Q;P="QuestionName"+Q;if(!C) A.addparm(O,E.text);if(!C) A.addparm(P,E.arAddedInfo[i]);if(!C) A.addparm(I,E.arStatements[i]);if(C) if (D) A.addparm('entry_1'+padDigits(A.getCount(),6),E.arChoices[j]);else A.addparm('entry.'+A.getCount()+'.single',E.arChoices[j]);else A.addparm(J,E.arChoices[j]);R++;}};if(!C) A.addparm("AnswerAll"+Q,H);};break;case 5:case 13:if(!C) A.addparm(I,E.text);if(E.strOurAns==null||E.strOurAns.length==0||E.strOurAns=="~~~null~~~") H=trivstrNA;else H=E.strOurAns;if(C) if (D) A.addparm('entry_1'+padDigits(A.getCount(),6),H);else A.addparm('entry.'+A.getCount()+'.single',H);else A.addparm(J,H);if(!E.bSurvey&&!C){G=E.corrAns.indexOf('|');if(G>=0) H=E.corrAns.substring(0,G);else H=E.corrAns;A.addparm(K,H);};break;case 4:case 3:if(!C) A.addparm(I,E.text);if(E.strOurAns==null||E.strOurAns.length==0||E.strOurAns=="~~~null~~~") H=trivstrNA;else H=E.strOurAns;if(C) if (D) A.addparm('entry_1'+padDigits(A.getCount(),6),H);else A.addparm('entry.'+A.getCount()+'.single',H);else A.addparm(J,H);break;case 7:case 6:if(!C) A.addparm(I,E.text);var T;if(E.bGradeInd){for(F=0;F<E.arCorrAns.length;F++){T=E.arCorrAns[F].substring(0,E.arCorrAns[F].indexOf('-'));H=GetMatchingPairStr(T,E.strOurAns);if(H==null||H.length==0) H=trivstrNA;A.addparm(J,H);if(!C) A.addparm(K,E.arCorrAns[F]);if(F<E.arCorrAns.length-1){B++;Q=B;I="Q"+Q;J="Answer"+Q;K="CorrectAnswer"+Q;L="QuestionType"+Q;M="QuestionID"+Q;N="Section"+Q;if(!C) A.addparm(I,E.text);if(!C) A.addparm(L,E.type);if(!C) A.addparm(M,E.id);if(E.iSectionId>0&&!C) A.addparm(N,E.iSectionId);}}}else{if(E.strOurAns==null||E.strOurAns.length==0||E.strOurAns=="~~~null~~~") H=trivstrNA;else{var U;H="";if (E.arCorrAns.length===1&&!E.arCorrAns[0]&&E.arCorrAns[0]!==0) H=E.strOurAns;else for(F=0;F<E.arCorrAns.length;F++){T=E.arCorrAns[F].substring(0,E.arCorrAns[F].indexOf('-'));U=GetMatchingPairStr(T,E.strOurAns);if(U==null||U.length==0) H+=trivstrNA;else H+=U;if(F<E.arCorrAns.length-1) H+=",";}};if(C) A.addparm(D?('entry_1'+padDigits(A.getCount(),6)):('entry.'+A.getCount()+'.single'),H);else{A.addparm(J,H);A.addparm(K,E.corrAns);}};break;};return B;};TQPr.getNEResult=function () {var A=this;var B="";var y=0;for (var i=0;i<A.arRel.length;i++) {var C=" "+A.separator+" ";if (i==0) C="";switch (parseInt(A.arRel[i])) {case 1:B+=C+"= "+A.arCorrAns[y];break;case 2:B+=C+"( >= "+A.arCorrAns[y]+" "+trivstrAnd+" <= "+A.arCorrAns[y+1]+" )";y++;break;case 3:B+=C+"( > "+A.arCorrAns[y]+" "+trivstrAnd+" < "+A.arCorrAns[y+1]+" )";y++;break;case 4:B+=C+"> "+A.arCorrAns[y];break;case 5:B+=C+">= "+A.arCorrAns[y];break;case 6:B+=C+"< "+A.arCorrAns[y];break;case 7:B+=C+"<= "+A.arCorrAns[y];break;case 8:B+=C+"!= "+A.arCorrAns[y];break;};y++;};return B;};
