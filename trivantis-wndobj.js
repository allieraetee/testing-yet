
		/*
 * Copyright (C) 2007 Trivantis Corporation
 */

	
function jsWndObj(){var A=this;A.actFlags=0;A.bLButtonDown=0;A.cwObj=n;A.rtRect=new jsRect(0,0,0,0);A.name=n;A.div=n;A.ptPending=new jsPoint(-1,-1);A.ptPending.x=n;A.ptDown=new jsPoint(-0,0);A.dCon=n;A.idSize=n;A.rectSize=n;A.zindex=0;A.bEnabled=1;A.currTrans=0;A.rcdData=new jsRcdAttachData();A.rcdState=new jsRcdState();if (A.designTime){jsWndObj.prototype.designTime.call(A);A.designTime();}};var p=jsWndObj.prototype;p.attach=function(A){var B=this,C=B.rcdGetAttData(),D=C.htmlId,E=C.objData,F=C.bInsAnc,G=E.a;B.div=document.getElementById(D);if (B.div){B.div.tObj=B;var H=String(B.div.id);while (H&&H.length&&isNaN(H)) H=H.substring(1);if (H&&H.length){var I=document.createElement('A');I.name=String(H)+'anc';var J="javascript://"+H;var K=B.div.firstChild;I.href=J;if (F&&K){B.div.removeChild(K);B.div.appendChild(I);I.appendChild(K);if (K.style.position=='absolute'){I.style.width=K.style.width;I.style.height=K.style.height;I.style.position='absolute';}}}};B.parPage=trivPage;B.actFlags=G[0];B.dwFlags=G[1];var L=B.cwObj,M=(L&&L.par)?L.par:n;L=new cwObjPub();B.cwObj=L;L.wnd=B;L.par=M;L.transData=G[2];B.rtRect.set(G[3][0],G[3][1],G[3][2],G[3][3]);if (L.getTrans(t)||L.getTrans(f)){L.rect=B.rtRect.copy();if (typeof G[2][6]!='undefined'){L.rect.x=G[2][6];L.rect.y=G[2][7];}};var N=L.getTrans(t);if (B.div&&N&&!A){if (!jsTrans.isFIFO(N)||jsTrans.isFloat(N)) B.div.style.visibility='hidden';};B.bLiveWin=E.bLiveWin;if (B.div&&A){if (N&&N>=24&&N<=34){B.div.style.left=L.transData[6]+'px';B.div.style.top=L.transData[7]+'px';}};if (C.cwObj){for (var O in C.cwObj) L[O]=C.cwObj[O];}};p.postAttach=function(A) {};p.rcdGetAttData=function() {var A=this.rcdData['att_'+rcdObj.view];if (A==u) A=this.rcdData['att_'+DEFAULT_VIEW];return A;};p.updateDiv=function(A){var B=this,C=B.rcdGetAttData(),D=f,E=B.div;if (!E){E=document.createElement('div');B.div=E;var F=E;if (C.fieldsetId){F=document.getElementById(C.fieldsetId);if (!F){F=document.createElement('fieldset');F.id=C.fieldsetId;var G=F.style;G.border='0';G.fontSize='1px';G.width='1px';G.height='1px';};F.appendChild(E);};document.getElementById('wndPage').appendChild(F);}else D=E.style.visibility;if (!A){E.innerHTML=C.innerHtml;E.id=C.htmlId;};E.style.cssText=C.cssText;if (D!==f) E.style.visibility=D;var H=[];if(C.cssClasses.length) H=C.cssClasses.split(',');for (var i=0;i<H.length;i++){var I=H[i].trim();var J=[];if(E.className.length) J=E.className.split(" ");if(I&&(J.indexOf(I)==-1)) E.className+=" "+I;}};p.editMode=function() {return (this.designTime&&titleData.mode==1);};p.mouseDown=function(e){var A=this;if (A.editMode()) A.mouseDownEdit(e);else{if(e.which==1||(e.which==n&&(e.button==0||e.button==1))){A.bLButtonDown=1;var B=A.cwObj;if(A.designTime&&B&&B.par&&B.par.type==13){var C=B.par.isLiveQuestObject(B);if(C) A.parPage.questObjMouseDown(A,e,C);} else if(!A.designTime){if (A.down) return A.down();}}}};p.mouseMove=function(e){var A=this;if (A.editMode()) A.mouseMoveEdit(e);else{var B=A.cwObj;if(A.designTime&&B&&B.par&&B.par.type==13){var C=B.par.isLiveQuestObject(B);if(C) A.parPage.questObjMouseMove(A,e,C);}}};p.mouseUp=function(e){var A=this;if(A.parPage.rtData1!=-1){if(document.releaseEvents) document.releaseEvents(Event.MOUSEMOVE);if(document.releaseEvents) document.releaseEvents(Event.MOUSEUP);document.onmousemove=A.parPage.rtData1;document.onmouseup=A.parPage.rtData2;A.parPage.rtData1=-1;A.parPage.rtData2=-1;};if (A.editMode()) A.mouseUpEdit(e);else{try{if (A.bLButtonDown&&(A.actFlags&0x4)) A.issueActions(2);var B=A.cwObj;if (A.designTime&&B&&B.par&&B.par.type==13){var C=B.par.isLiveQuestObject(B);if (C) A.parPage.questObjMouseUp(A,e,C);}} finally{A.bLButtonDown=0;}}};p.mouseEnter=function(){if(!(this.editMode())) if (this.actFlags&0x1) this.issueActions(0);};p.mouseExit=function(){if(!(this.editMode())) if (this.actFlags&0x2) this.issueActions(1);};p.mouseDblClk=function(e){if(this.editMode()) this.mouseDblClkEdit(e);else if(this.actFlags&0x8) this.issueActions(3);};p.contextMenu=function(e){if(this.editMode()) this.contextMenuEdit(e);else if(this.actFlags&0x200){this.issueActions(9);return cancelEvent(e);};if (this.designTime) return cancelEvent(e);};p.isPlaying=function(){return f;};p.play=function(){};p.actionPlay=p.play;p.stop=function(){};p.actionStop=p.stop;p.isVisible=function(){return (this.div&&this.div.style.visibility!='hidden');};p.show=function(){var A=this;if (A.div){var B=A.div.style;var C=window.titleData&&(titleData.publishTextOnly||titleData.isPrinting)?true:false;if(!A.editMode()){var D=A.isVisible();if(!A.bShown){A.bShown=t;D=f;};if (C) B.visibility='inherit';else{if(D||A.isTransitioning(t)) return;if(A.isTransitioning(f)) A.cancelTrans();if((!A.cwObj)||!A.cwObj.getTrans||!A.cwObj.getTrans(t)) B.visibility='inherit';};if(A.actFlags&0x20) A.issueActions(5);}else B.visibility='inherit';}};p.actionShow=p.show;p.hide=function(){var A=this;if(!(A.editMode())){if(A.isVisible()==f||A.isTransitioning(f)||!A.div) return;if(A.isTransitioning(t)) A.cancelTrans();if((!A.cwObj)||!A.cwObj.getTrans(f)) A.div.style.visibility='hidden';if(A.actFlags&0x100) A.issueActions(8);}else A.div.style.visibility='hidden';};p.actionHide=p.hide;p.actionTogglePlay=p.togglePlay;p.actionToggleShow=p.toggleShow;p.issueActions=function(A){var B=this;var C=B.cwObj;var D=window.titleData&&(titleData.publishTextOnly||titleData.isPrinting)?true:false;if(!D){if ((A==5&&C.getTrans(t))||(A==8&&C.getTrans(f))){if(B.timerIn) clearTimer(B.timerIn);if(B.timerOut) clearTimer(B.timerOut);if(B.currTrans&&B.transTmrId){clearTimeout(B.transTmrId);B.transTmrId=n;B.transDone(B);};if(!B.currTrans) B.setTrans(A==5);var E=C.getTransDelay(A==5);trivLogMsg("Transition started to "+(A==5?"show":"hide")+" ["+B.div.id+"] with a "+E+"ms delay",4);if(A==5) B.parPage.arTransInWnds.push(B);else B.parPage.arTransOutWnds.push(B);if(E) B.transTmrId=setTimeout(function(){ B.transTmrId=n;B.doTrans(A==5);},E);else B.doTrans(A==5);return;}};B.issueActionsInternal(A,D);};p.issueActionsInternal=function(A,B){var C=this;var D=C.cwObj;var E=C.parPage;var F=E?E.arDelayAct:n;var G=C.designTime?wndPage.currPage:0;if (D==u||E==u||(C.div&&C.div.innerHTML=='')) return;trivArExec(D.arChld,function(J,i){if (C.designTime&&G!==wndPage.currPage) return f;if(J.type==6&&J.on==A){if(!J.delay){if (B){var H=J.actItem.action;if (!(H==8||H==11||H==22||H==23||H==28||H==3||H==4)) return;};E.doAction(J.actItem,J.elseItem,J);}else if (!B){var I=setTimeout(function(){for(var j=0;j<F.length;j++) {if(F[j]==I){F.splice(j,1);break;}};E.doAction(J.actItem,J.elseItem,J);},J.delay);F.push(I);}}});};p.isTransitioning=function(A){var B=this.div;if(B&&B.bTrans&&B.bIn==A) return t;return f;};p.cancelTrans=function(){var A=this;var B=A.div;B.bTrans=f;if(jsTrans.isFIFO(A.currTrans)){B.style.left=B.fX+'px';B.style.top=B.fY+'px';if(!B.bIn) B.style.visibility="hidden";}else B.style.clip="rect(0px "+A.cwObj.rect.width+"px "+A.cwObj.rect.height+"px 0px)";A.transDone(A);};p.updatePosForTrans=function(A){var B=this;var C=B.cwObj;var D=B.rtRect;var E=B.currTrans;var F=B.parPage;var G=20;var H=new jsRect(C.getXPos(F.currPage),C.getYPos(F.currPage),C.rect.width,C.rect.height);if(B.bHasMoved){H.x=D.x;H.y=D.y;};if(B.bHasSized){H.width=D.width;H.height=D.height;};D.setRect(H);var I=new jsRect(0,0,parseInt(F.div.style.width),parseInt(F.div.style.height));if (B.designTime){var J=C.par;var K=n;while(J){var L=titleData.isGroup(J);if (!L) break;if(J.getTrans(A)) K=J;J=J.par;};if(K){var M=H.copy();K.getBoundingRect(M,F.currPage);if(A){if(E==31||E==30||E==29) I.x-=(M.right()-H.right());if(E==31||E==24||E==25) I.y-=(M.bottom()-H.bottom());if(E==25||E==26||E==27) I.width+=(H.x-M.x);if(E==29||E==28||E==27) I.height+=(H.y-M.y);}else{if(E==31||E==30||E==29) I.x-=(M.right()-H.right());if(E==31||E==24||E==25) I.y-=(M.bottom()-H.bottom());if(E==25||E==26||E==27) I.width+=(H.x-M.x);if(E==29||E==28||E==27) I.height+=(H.y-M.y);}}};if(A){if(E==31||E==30||E==29){D.x=I.x-G-H.width;}else if(E==25||E==26||E==27){D.x=I.right()+G+H.width;};if(E==25||E==24||E==31){D.y=I.y-G-H.height;}else if(E==27||E==28||E==29){D.y=I.bottom()+G+H.height;};B.moveTo(D.x,D.y);}else{B.rectTransOut=H.copy();if(E==31||E==30||E==29){B.rectTransOut.x=I.x-G-H.width;}else if(E==25||E==26||E==27){B.rectTransOut.x=I.right()+G+H.width;};if(E==25||E==24||E==31){B.rectTransOut.y=I.y-G-H.height;}else if(E==27||E==28||E==29){B.rectTransOut.y=I.bottom()+G+H.width;}}};p.doTrans=function(A,B,C,D){var E=this;var F=E.div;if (!F) return;if(jsTrans.isFIFO(E.currTrans)){if(A) doDivTrans(f,F,E.currTrans,(11-E.cwObj.getTransSpeed(A)),C?C:E.transDone,E,E.cwObj.getXPos(),E.cwObj.getYPos(),E.cwObj.getTransEffect(A));else if(E.rectTransOut) doDivTrans(t,F,E.currTrans,(11-E.cwObj.getTransSpeed(A)),C?C:E.transDone,E,E.rectTransOut.x,E.rectTransOut.y,E.cwObj.getTransEffect(A));else E.currTrans=0;}else doDivTrans(!A,F,E.currTrans,(11-E.cwObj.getTransSpeed(A)),C?C:E.transDone,E);};p.transDone=function(A){if(!A.div) return;A.currTrans=0;A.rtRect.x=parseInt(A.div.style.left);A.rtRect.y=parseInt(A.div.style.top);var i=0;for(i=0;i<A.parPage.arTransInWnds.length;i++){if(A.parPage.arTransInWnds[i]==A){A.parPage.arTransInWnds.splice(i,1);if(A.actFlags&0x20) A.issueActionsInternal(5);return;}};for(i=0;i<A.parPage.arTransOutWnds.length;i++){if(A.parPage.arTransOutWnds[i]==A){A.parPage.arTransOutWnds.splice(i,1);if(A.actFlags&0x100) A.issueActionsInternal(8);break;}};if(!A.parPage.arTransOutWnds.length&&A.parPage.fDelayedSwitch){A.parPage.switchPage(A.parPage.nextPage,0,A.parPage._bNoFeedback==undefined?0:A.parPage._bNoFeedback,1);}};p.setTrans=function(A){var B=this;B.currTrans=B.cwObj.getTrans(A);if(B.currTrans){B.currTrans=jsTrans.xlateTrans(B.currTrans,B.cwObj.objType,n,B.cwObj.bLiveWin);B.updatePosForTrans(A);}};p.toggleVisibility=function(){if (this.isVisible()) this.hide();else this.show();};p.enable=function(A){this.bEnabled=A;};p.getRect=function(){return (this.rtRect.copy());};p.moveTo=function(x,y){var A=this;A.rtRect.x=parseInt(x);A.rtRect.y=parseInt(y);if (A.div){A.div.style.left=x+'px';A.div.style.top=y+'px';}};p.moveBy=function(x,y){var A=this.rtRect;var B=this.div;A.x+=x;A.y+=y;if (B){B.style.left=parseInt(A.x)+'px';B.style.top=parseInt(A.y)+'px';}};p.sizeTo=function(w,h,A){var B=this;if(w<0)w=0;if(h<0)h=0;B.rtRect.width=w;B.rtRect.height=h;if (B.div){B.div.style.width=w+'px';B.div.style.height=h+'px';if(!isNaN(A)) B.div.style.fontSize=A+'pt';};if(B.dCon){B.dCon.style.width=w+'px';B.dCon.style.height=h+'px';if(!isNaN(A)) B.dCon.style.fontSize=A+'pt';}};p.flsLoading=function(A){if (!A||typeof A.PercentLoaded=='undefined') return t;return (A.PercentLoaded()!=100);};p.initEvent=function(){var A=this;if (theApp.is.useHTML5Audio()||theApp.is.useHTML5Video()){var B=A.div.getElementsByTagName('video');if (!B.length) B=A.div.getElementsByTagName('audio');B=B.length?B[0]:n;var C=A.cwObj?A.cwObj:A.audio.cwObj;B.addEventListener("timeupdate",function(){if (C&&C.arEvents){for (var i=0;i<C.arEvents.length;i++){if (!(A&&B)) return;var D=C.arEvents[i];var E=Number(D.value)/1000;if (!D.proc&&B.currentTime>=E&&B.currentTime<=B.duration){D.proc=true;A.onEvent(D.name);}}};if (!(A&&A.clearEventsFlag)) return;A.clearEventsFlag(B.currentTime);},false);B.addEventListener("ended",function(){A.clearEventsFlag(-1);},false);}};p.clearEventsFlag=function(A) {var B;if(this.cwObj==undefined) B=this.audio.cwObj;else B=this.cwObj;for (var i=0;i<B.arEvents.length;i++) {var C=B.arEvents[i];var D=Number(C.value)/1000;if (C&&C.proc&&A<D) C.proc=false;}};p.updateIndicators=function(A){var B=this;if(!this.div||!trivPageTracking||!B.arrStatusImages||B.arrStatusImages.length!=3) return;var C=A;if(C==undefined||C.length==0) C=this.div.getElementsByTagName('IMG');if (C) for(var D=0;D<C.length;D++) {if(C[D]&&C[D].id.substring(0,8)=='TOCPTIND'){var E=C[D].id.substring(8);var F=C[D].src;var G=trivPageTracking.GetRangeStatus(E);G=G=="complete"?2:(G=="inprogress"?1:0);var H=F.lastIndexOf("/");var I=B.arrStatusImages[G];if(H!=-1){C[D].src=F.substring(0,H+1)+(I.length?I:B.arrStatusImages[2]);C[D].style.visibility=I.length?'':'hidden';}}}};function jsWndImage(){jsWndObj.prototype.constructor.call(this);};p=jsWndImage.prototype=new jsWndObj();p.constructor=jsWndImage;p.attach=function(A){var B=this,C=n;jsWndObj.prototype.attach.call(B,A);if (A&&B.dCon) C=B.dCon.src;B.dCon=B.div.getElementsByTagName('IMG')[0];if (C&&(B.rcdState.firedActions&8)) B.dCon.src=C;};p.isVisible=function(){return (this.currTrans?t:jsWndObj.prototype.isVisible.call(this));};p.changeContents=function(A,B,C){if (this.dCon){var D=this.designTime?A.getLink():A;if (!this.designTime&&theApp.is.ie6){if (this.dCon.src.indexOf('.png')==this.dCon.src.length-4){this.div.style.filter='';this.dCon.style.filter='';};if (D.indexOf('.png')==D.length-4){this.div.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+D+"',sizingMethod='scale')";this.dCon.style.filter='progid:DXImageTransform.Microsoft.Alpha(opacity=0)';}};this.dCon.src=D;if (C==u) this.rcdState.firedActions|=8;}};function jsWndButton(){jsWndObj.prototype.constructor.call(this);};p=jsWndButton.prototype=new jsWndObj();p.constructor=jsWndButton;p.attach=function(A){var B=this,C=B.rcdGetAttData().objData;jsWndObj.prototype.attach.call(B,A);B.dCon=B.div.getElementsByTagName('IMG')[0];B.src=C.res;B.clickSrc=C.resClick;B.overSrc=C.resOver;B.div.style.cursor="pointer";};p.mouseDown=function(e){if(!this.editMode()) this.dCon.src=this.clickSrc;return jsWndObj.prototype.mouseDown.call(this,e);};p.mouseUp=function(e){var A=this;if(!(A.editMode())){A.dCon.src=theApp.is.mobile?A.src:A.overSrc;if(A.bLButtonDown) A.parPage.doAction(A.cwObj.actItem,n,A.cwObj);};return jsWndObj.prototype.mouseUp.call(A,e);};p.mouseMove=function(e){if(this.editMode()) return jsWndObj.prototype.mouseMove.call(this,e);};p.mouseEnter=function(){if(!(this.editMode())){this.dCon.src=this.bLButtonDown?this.clickSrc:this.overSrc;return jsWndObj.prototype.mouseEnter.call(this);}};p.mouseExit=function(){if((!this.editMode())&&this.dCon){this.dCon.src=this.src;return jsWndObj.prototype.mouseExit.call(this);}};function jsWndAnimImage(){jsWndObj.prototype.constructor.call(this);};p=jsWndAnimImage.prototype=new jsWndObj();p.constructor=jsWndAnimImage;p.attach=function(A){var B=this,C=B.rcdGetAttData().objData;jsWndObj.prototype.attach.call(B,A);B.bIsFlash=C.isFlash;B.getFlashObj();B.dCon=B.div.getElementsByTagName(B.bIsFlash?'DIV':'IMG')[0];};p.getFlashObj=function(){var A=this;if (!A.bIsFlash) return f;try {if (!A.flshObj) A.flshObj=A.div.getElementsByTagName((theApp.is.ie10orLess?'object':'embed'))[0];} catch (e) {if (A.designTime) theApp.error(e);};return A.flshObj;};p.fReadyChk=function(A,B){B=B?B:0;if (B>4) return f;var C=this;var D=C.getFlashObj();var E=t;if ((!D)||typeof(D.PercentLoaded)=='undefined'||D.PercentLoaded()!=100){setTimeout(function(){A.call(C,++B);},100);E=f;};return E;};p.play=function(A){if (this.fReadyChk(this.play,A)) this.flshObj.Play();};p.stop=function(A){if (this.fReadyChk(this.stop,A)){this.flshObj.GotoFrame(0);this.flshObj.StopPlay();}};p.togglePlay=function(A){if (this.fReadyChk(this.play,A)){if (this.flshObj.IsPlaying()) this.flshObj.StopPlay();else this.play();}};p.pause=function(A){if (this.fReadyChk(this.pause,A)) this.flshObj.StopPlay();};p.gotoNextFrame=function(A){if (this.fReadyChk(this.gotoNextFrame,A)){var B=this.flshObj.CurrentFrame()+1;this.flshObj.GotoFrame(B);}};p.gotoPrevFrame=function(A){if (this.fReadyChk(this.gotoPrevFrame,A)){var B=this.flshObj.CurrentFrame()-1;this.flshObj.GotoFrame(B);}};p.gotoLabel=function(A){var B=this.getFlashObj();if(B) B.TGotoLabel('/',A);};p.setVariable=function(A,B){var C=this.getFlashObj();if(C) C.SetVariable(A,B);};p.getVariable=function(A){var B=this.getFlashObj();if(B) return B.GetVariable(A);return 0;};p.isPlaying=function(){var A=this.getFlashObj();if(A) return A.IsPlaying();return t;};p.gotoFrame=function(A){var B=this.getFlashObj();if(B) B.GotoFrame(A);};p.callFunction=function(A,B,C){var D=n;var E=this;if (!C) C=0;else if (C>4) return;var F=this.getFlashObj();if(F&&typeof F[A]!="undefined"){if(B==null||B=='') D=F[A]();else D=F[A](B);}else setTimeout(function(){E.callFunction(A,B,++C);},250);return D;};p.isDone=function(){var A=this.getFlashObj();if(!A||typeof A.CurrentFrame=="undefined") return;var B=parseInt(A.CurrentFrame())+1;var C;if(theApp.is.ie10orLess) {C=parseInt(A.TotalFrames);}else        {C=parseInt(A.TotalFrames());};if((!A.IsPlaying()&&this.autoPlay)||B>=C) {this.onDone();window.clearInterval(this.hasDone);}};p.onDone=function() {if (this.actFlags&0x40) this.issueActions(6);};function jsWndAudio(){jsWndObj.prototype.constructor.call(this);};p=jsWndAudio.prototype=new jsWndObj();p.constructor=jsWndAudio;p.isVisible=function(){return (this.div&&this.div.style.visibility!='hidden'&&!this.initHidden);};p.show=function(){var A=this;if(A.initHidden){var B=A.rtRect;var C=A.div.style;var D=A.name;C.left=B.x+'px';C.top=B.y+'px';C.width=B.width+'px';C.height=B.height+'px';if(A.cwObj.iDisplay==2){var E=['swf'+D,'embed'+D,D+'obj'];for(var i=0;i<E.length;i++){var F=document.getElementById(E[i]);if(F){F.width=B.width;F.height=B.height;}};A.snd.div.style.visibility='inherit';var G=A.snd.div.getElementsByTagName('div');if(G&&G.length) G[0].style.display='none';};A.snd.show();};A.initHidden=f;if(theApp.is.useHTML5Audio()&&A.cwObj.iDisplay==2){var H=A.div.getElementsByTagName("audio");H=H.length?H[0]:f;if (H) H.controls=t;};jsWndObj.prototype.show.call(A);};p.hide=function(){var A=this;A.manualHide=t;if(theApp.is.useHTML5Audio()&&A.cwObj.iDisplay==2){var B=A.div.getElementsByTagName("audio");B=B.length?B[0]:f;if (B) B.controls=f;};jsWndObj.prototype.hide.call(A);};p.attach=function(A,B,C,D){var E=this,F=E.cwObj,G=E.rcdGetAttData(),H=G.htmlId,I=(B!=u),J=(E.rcdState.firedActions&8)!=0,K=(F==u||!(F instanceof cwObjPub))?t:f,L=E.__prevResource!=G.resource;B=B?B:G.objData;if(!C) C=G.stdHtml;if(!D) D=G.iosHtml;if(!C) C=E.stdHtml;if(!D) D=E.iosHtml;var M=B.a;if(theApp.is.useHTML5Audio()&&B.iDisplay==2) if(M[3][4]) M[3][3]+=M[3][4];jsWndObj.prototype.attach.call(E,A);F=E.cwObj;E.name=H;F.arEvents=G.arEvents;if(typeof E.initHidden=='undefined') E.initHidden=B.initHidden;var N=(E.initHidden!=B.initHidden);E.initHidden=B.initHidden;if(E.manualHide){E.div.style.visibility='inherit';};F.iDisplay=B.iDisplay;E.snd=new jsSound();var O=document.getElementById("snd"+H);E.snd.div=O;if (O&&(K||I||(!J&&L))){O.innerHTML=(theApp.is.useHTML5Audio()?D:C);O.tObj=E;E.__prevResource=G.resource;};E.snd.audio=E;F.isFlashAudio=function(){return B.isFlash;};F.hasEvents=function(){return B.hasEvents;};F.supportsEvents=function(){return B.supportsEvents;};F.linkName=B.linkName;E.onDone=function() { E.snd.onDone();};E.onEvent=function(o) { E.snd.onEvent(o);};if(theApp.is.useHTML5Audio()){var P=O.getElementsByTagName("audio");P=P.length?P[0]:n;if (P){P.addEventListener('ended',E.onDone,false);if(E.dwFlags&0x20000){P.load();P.play();}}};var Q=(O?O.getElementsByTagName('div'):n);if(Q&&Q.length&&!theApp.is.ie10orLess&&E.cwObj.isFlashAudio()){Q[0].style.display='none';Q[0].style.overflow='hidden';};if(N) E.show();if (I) E.rcdState.firedActions|=8;};p.updateDiv=function(){var A=this.rcdGetAttData(),B=!!this.div;jsWndObj.prototype.updateDiv.call(this,B);if (!B&&A.objData.iDisplay!=2){var C=document.createElement('div');document.getElementById('wndPage').appendChild(C);C.innerHTML="";C.id='snd'+A.htmlId;C.style.position='absolute';C.style.left='0px';C.style.top='0px';C.style.width='1px';C.style.height='1px';C.style.opacity='.01';C.style.filter='alpha(opacity='+('1')+')';}};p.mouseDown=function(e){var A=this;if(!A.editMode()&&(A.cwObj.iDisplay==0||A.cwObj.iDisplay==3)){if(e.which==1||(e.which==n&&(e.button==0||e.button==1))) A.togglePlay();};return jsWndObj.prototype.mouseDown.call(A,e);};p.play=function(){if ((!this.editMode())&&this.snd) this.snd.play();};p.togglePlay=function(){if ((!this.editMode())&&this.snd) this.snd.togglePlay();};p.pause=function(){if ((!this.editMode())&&this.snd) this.snd.pause();};p.stop=function(){if ((!this.editMode())&&this.snd) this.snd.stop();};p.isPlaying=function(){if ((!this.editMode())&&this.snd) return this.snd.isPlaying();return f;};p.isResType=function(A){var B=this.cwObj;var C=(this.cwObj.res&&B.res.linkName)?B.res.linkName:(B.linkName?B.linkName:"");if(!C||!C.length||!A||!A.length) return 0;var D="";for(var i=0;i<A.length;i++) {if(D.length) D+="|";D+=("\\."+A[i]);};if(!D.length) return 0;D=".*("+D+")$";var E=RegExp(D,"i");return E.test(C);};p.actionMute=function(){if ((!this.editMode())&&this.snd) return this.snd.mute();};p.actionUnMute=function(){if ((!this.editMode())&&this.snd) return this.snd.unMute();};function jsBgSound(){var A=this;A.audio=n;};p=jsBgSound.prototype=new jsWndObj();p.constructor=jsBgSound;p.attach=function(A){var B=this.getTitleMgrDoc();if (B){this.setPlayingState(B.bBkgAudPlaying!=u?B.bBkgAudPlaying:1);var C=B.getElementById("bkgrndAud");if (A&&!C){C=B.createElement("audio");C.id="bkgrndAud";C.src=A;C.orgsrc=A;C.controls="false";C.hidden="true";C.autoplay="true";C.loop="loop";C.style.display="none";B.body.appendChild(C);this.bkaud=C;}else if (A&&C&&C.orgsrc!=A){C.src=A;C.orgsrc=A;}else if (!A&&C){B.body.removeChild(C);C=n;};this.bkaud=C;if (C&&!B.bBkgAudPlaying) this.stop();}};p.play=function(){var A=this;if (A.bkaud){A.bkaud.play();A.setPlayingState(t);}};p.togglePlay=function(){var A=this;if (A.bkaud){if (A.isPlaying()) A.bkaud.pause();else A.bkaud.play();A.setPlayingState(!A.isPlaying());}};p.pause=function(){if (this.bkaud){this.bkaud.pause();this.setPlayingState(f);}};p.stop=function(){if (this.bkaud){this.bkaud.currentTime=0;this.bkaud.pause();this.setPlayingState(f);}};p.actionMute=function(){if (this.bkaud) this.bkaud.muted=t;};p.actionUnMute=function(){if (this.bkaud) this.bkaud.muted=f;};p.isPlaying=function(){var A=this.getTitleMgrDoc();return A?A.bBkgAudPlaying:f;};p.setPlayingState=function(A){var B=this.getTitleMgrDoc();if (B) B.bBkgAudPlaying=A;};p.getTitleMgrDoc=function(){var A=n;try{A=getTitleMgrWnd(window,0);if (A) A=A.document;}catch (e) {};A=A?A:window.document;return A;};function jsSound(){var A=this;A.audio=n;A.bPlaying=0;A.winMgrId=n;A.flsPlayer=n;A.wmPlayer=n;A.wmEventHandlerScripts=[];};p=jsSound.prototype=new jsWndObj();p.constructor=jsSound;p.show=function() {var A=this;var B=A.audio.rtRect;var C=A.div.style;C.left='0px';C.top='0px';C.width=B.width+'px';C.height=B.height+'px';C.opacity='1';C.filter='alpha(opacity=100)';};p.onEvent=function(A) {var B=this.audio.cwObj;trivLogMsg("Event ["+A+" on "+B.name+"] fired!",4);var C=this.designTime?wndPage:trivPage;if (!B.hasEvents()) return;trivArExec(B.arEvents,function(o,i){if (o.name==A) {C.doAction(o.actItem);return f;}});};p.onDone=function() {if (this.audio.actFlags&0x40) this.audio.issueActions(6);};p.play=function(){var A=this;if (A.div){var B=A.div.getElementsByTagName('embed');if (theApp.is.useHTML5Audio()){var C=A.div.getElementsByTagName("audio");C=C.length?C[0]:n;if (C) C.play();}else if (A.audio.cwObj.isFlashAudio()){A.setFlashPlayer();if (A.flsLoading(A.flsPlayer)){theApp.SetTimeout(A.play,100,A);return;};if (!A.isPlaying()) setTimeout(function(){A.flsPlayer.sendEvent('play');},500);}else if ((A.audio.cwObj.supportsEvents()||B.length==0)&&theApp.is.ie){A.setWmPlayer();if (A.wmPlayer&&A.wmPlayer.controls) A.wmPlayer.controls.play();}else{var D=(typeof B[0].controls=='object'?B[0].controls:B[0]);if (D){if (typeof D.pause!=='undefined'&&(!this.isOldWM(D)||D.playState!==3)){D.play();}else if (typeof D.Step!=='undefined'){var E=D.GetPluginStatus();if (!E) return;if (E.IContains('waiting')||E.IContains('playable')){setTimeout(function(){A.play();},100);return;};if (!E||!E.IContains('complete')) return;D.Play();}else if (typeof D.DoPause!=='undefined'){if(!A.bPlaying) D.DoPlayPause();}else{A.resetEmbed((A.audio.cwObj.dwFlags&0x80000>0),t);}}};A.bPlaying=1;}};p.togglePlay=function(){var A=this;if (A.div){var B=A.div.getElementsByTagName('embed');if (theApp.is.useHTML5Audio()){var C=A.div.getElementsByTagName("audio");C=C.length?C[0]:n;if (C){if (A.bPlaying) C.pause();else C.play();}}else if(A.audio.cwObj.isFlashAudio()){A.setFlashPlayer();if (A.flsLoading(A.flsPlayer)){theApp.SetTimeout(A.togglePlay,100,A);return;};A.flsPlayer.sendEvent('play');}else if ((A.audio.cwObj.supportsEvents()||B.length==0)&&theApp.is.ie){A.setWmPlayer();if (A.wmPlayer&&A.wmPlayer.controls){A.setPlayState(A.wmPlayer);if (A.bPlaying) A.wmPlayer.controls.pause();else A.wmPlayer.controls.play();}}else{var D=(typeof B[0].controls=='object'?B[0].controls:B[0]);if (D){A.setPlayState(D);if (typeof D.pause!=='undefined'){if (A.bPlaying) D.pause();else D.play();}else if (typeof D.Step!=='undefined'){var E=D.GetPluginStatus();if (!E) return;if (E.IContains('waiting')||E.IContains('playable')){setTimeout(function(){A.togglePlay();},100);return;};if (!E.IContains('complete')) return;if (A.bPlaying) D.Stop();else D.Play();}else if (typeof D.DoPause!=='undefined'){D.DoPlayPause();}}};A.bPlaying=(A.bPlaying==1?0:1);}};p.pause=function(){var A=this;if (A.div){var B=A.div.getElementsByTagName('embed');if (theApp.is.useHTML5Audio()){var C=A.div.getElementsByTagName("audio");C=C.length?C[0]:n;if(C) C.pause();}else if (A.audio.cwObj.isFlashAudio()){A.setFlashPlayer();if (A.flsLoading(A.flsPlayer)){theApp.SetTimeout(A.pause,100,A);return;};if (A.isPlaying()) A.flsPlayer.sendEvent('play');}else if ((A.audio.cwObj.supportsEvents()||B.length==0)&&theApp.is.ie){A.setWmPlayer();if (A.wmPlayer&&A.wmPlayer.controls) A.wmPlayer.controls.pause();}else{var D=(B.length?(typeof B[0].controls=='object'?B[0].controls:B[0]):n);if (D){if (typeof D.pause!=='undefined'){D.pause();}else if (typeof D.Step!=='undefined'){var E=D.GetPluginStatus();if (!E||!E.IContains('complete')) return;D.Stop();}else if (typeof D.DoPause!=='undefined'){D.DoPause();}}};A.bPlaying=0;}};p.stop=function(){var A=this;if (A.div){var B=A.div.getElementsByTagName('embed');if (theApp.is.useHTML5Audio()){var C=A.div.getElementsByTagName("audio");C=C.length?C[0]:n;if(C){C.pause();C.currentTime=0;}}else if (A.audio.cwObj.isFlashAudio()){A.setFlashPlayer();if (A.flsLoading(A.flsPlayer)){theApp.SetTimeout(A.stop,100,A);return;};if (A.flsPlayer.sendEvent) A.flsPlayer.sendEvent('stop');}else if ((A.audio.cwObj.supportsEvents()||B.length==0)&&theApp.is.ie){A.setWmPlayer();if (A.wmPlayer&&A.wmPlayer.controls) A.wmPlayer.controls.stop();}else{var D=(B.length?(typeof B[0].controls=='object'?B[0].controls:B[0]):n);if (D){if (typeof D.pause!=='undefined'){D.stop();}else if (typeof D.Step!=='undefined'){var E=(typeof D.GetPluginStatus!=='undefined'?D.GetPluginStatus():"complete");if (!E||!E.IContains('complete')) return;D.Stop();if (typeof D.Rewind!=='undefined') D.Rewind();}else if (typeof D.DoPause!=='undefined'){D.DoStop();}else{A.resetEmbed(f,f);}}};A.bPlaying=0;}};p.mute=function(){var A=this;if (A.div){if (theApp.is.useHTML5Audio()){var B=A.div.getElementsByTagName("audio");B=B.length?B[0]:n;if(B) B.muted=t;}else if (A.audio.cwObj.isFlashAudio()){A.setFlashPlayer();if (A.flsLoading(A.flsPlayer)){theApp.SetTimeout(A.mute,100,A);return;};if(A.flsPlayer.sendEvent) A.flsPlayer.sendEvent('MUTE','true');}}};p.unMute=function(){var A=this;if (A.div){if (theApp.is.useHTML5Audio()){var B=A.div.getElementsByTagName("audio");B=B.length?B[0]:n;if(B) B.muted=f;}else if (A.audio.cwObj.isFlashAudio()){A.setFlashPlayer();if (A.flsLoading(A.flsPlayer)){theApp.SetTimeout(A.unMute,100,A);return;};if(A.flsPlayer.sendEvent) A.flsPlayer.sendEvent('MUTE','false');}}};p.setPlayState=function(A) {var B=this;if (!A){A=B.div.getElementsByTagName('embed');if (A) A=A[0];if (!A){A=B.div.getElementsByTagName('object');if (A) A=A[0];}};B.bPlaying=jsWndVideo.getPlayState(A,B.isOldWM(A),B.audio.cwObj.isFlashAudio());return B.bPlaying;};p.resetEmbed=function(A,B){var C=this.div;var D=null;for (var i=0;!D&&C.childNodes&&i<C.childNodes.length;i++) if(C.childNodes[i]&&C.childNodes[i].setAttribute) D=C.childNodes[i];if (D) {D.setAttribute("loop",A);D.setAttribute("autostart",B);C.innerHTML=C.innerHTML;}};p.setFlashPlayer=function() {var A=this;if (A.flsPlayer) return;if (theApp.is.ie10orLess) {var B=A.audio.cwObj;var C=(B.iDisplay==0||B.iDisplay==3?'Audio':'');A.flsPlayer=document['swf'+A.audio.name+C];} else {var D=A.div.getElementsByTagName('object');if (D.length&&typeof D[0].PercentLoaded!='undefined'){A.flsPlayer=D[0];}else{D=A.div.getElementsByTagName('embed');if (D.length&&typeof D[0].PercentLoaded!='undefined'){A.flsPlayer=D[0];}}}};p.setWmPlayer=function(){if (this.wmPlayer) return;if (theApp.is.ie) {this.wmPlayer=document[this.audio.name+'obj'];} else {var A=this.div.getElementsByTagName('object');if (A&&A.length>0) this.wmPlayer=(theApp.is.Mac?A[0]:A[0].getElementsByTagName('embed')[0]);}};p.isPlaying=function(){this.setPlayState();return this.bPlaying;};p.isOldWM=function(A){return (A&&theApp.is.ie10orLess&&typeof A.playState!='undefined'&&(typeof A.versionInfo=='undefined')&&this.audio.isResType(["mp3","wav","au","midi"]));};function jsWndVideo(){this.bPlaying=0;jsWndObj.prototype.constructor.call(this);};p=jsWndVideo.prototype=new jsWndObj();p.constructor=jsWndVideo;p.isVisible=function(){return (this.div&&this.div.style.visibility!='hidden'&&!this.initHidden);};p.show=function(){var A=this;if(A.initHidden){var B=A.rtRect,C=A.div.style,D=['video','object','embed'];C.left=B.x+'px';C.top=B.y+'px';C.width=B.width+'px';C.height=B.height+'px';C.opacity='1';C.filter='alpha(opacity=100)';for(var i=0;i<D.length;i++){var E=A.div.getElementsByTagName(D[i]);E=E.length?E[0]:n;if(E){E.width=B.width;E.height=B.height;}}};A.initHidden=f;jsWndObj.prototype.show.call(A);};p.attach=function(A,B,C,D){var E=this,F=E.cwObj,G=E.rcdGetAttData(),H=G.htmlId,I=(B!=u),J=(E.rcdState.firedActions&8)!=0,K=(F==u||!(F instanceof cwObjPub))?t:f,L=E.__prevResource!=G.resource;B=B?B:G.objData;if(!C) C=G.stdHtml;if(!D) D=G.iosHtml;if(!C) C=E.stdHtml;if(!D) D=E.iosHtml;E.dCon=E.div.getElementsByTagName('DIV')[0];var M=B.a;if(theApp.is.useHTML5Video()) if(M[3][4]) M[3][3]+=M[3][4];if(!K&&(I||(!J&&L))) E.stop();jsWndObj.prototype.attach.call(E,A);F=E.cwObj;E.name=H;F.arEvents=G.arEvents;if(typeof E.initHidden=='undefined') E.initHidden=B.initHidden;var N=(E.initHidden!=B.initHidden);E.initHidden=B.initHidden;if (K||I||(!J&&L)){if (!K){try{var O=E.dCon;var P=O.parentNode;O.innerHTML='';P.removeChild(O);var Q=document.createElement('div');Q.id=O.id;Q.style.cssText=O.style.cssText;P.appendChild(Q);E.wmPlayer=n;E.flsPlayer=n;E.dCon=Q;}catch(e) {  }};E.dCon.innerHTML=theApp.is.useHTML5Video()?D:C;E.__prevResource=G.resource;};F.isFlashVideo=function() {return B.isFlash;};F.hasEvents=function(){return B.hasEvents;};F.supportsEvents=function(){return B.supportsEvents;};if(theApp.is.useHTML5Video()){var R=E.div.getElementsByTagName("video")[0];if (K) R.addEventListener('ended',function() { E.onDone();},false);if(K&&E.dwFlags&0x20000){R.load();R.play();}};if(N) E.show();if (I) E.rcdState.firedActions|=8;};p.updateDiv=function(){var A=!!this.div;jsWndObj.prototype.updateDiv.call(this,A);};p.sizeTo=function(w,h){jsWndObj.prototype.sizeTo.call(this,w,h);if(theApp.is.useHTML5Video()){var A=this.div.getElementsByTagName('video')[0];A.width=w;A.height=h;}};p.onEvent=function(A){var B=this.cwObj;trivLogMsg("Event ["+A+"] fired!",4);if (!B.hasEvents()) return;var C=this.designTime?wndPage:trivPage;trivArExec(B.arEvents,function(o,i){if (o.name==A) C.doAction(o.actItem,n,B);});};p.onDone=function(){if (this.actFlags&0x40) this.issueActions(6);};p.play=function(){var A=this;if ((!A.editMode())&&A.dCon){var B=A.dCon.getElementsByTagName('embed');if(theApp.is.useHTML5Video()) {var C=A.div.getElementsByTagName("video");C=C.length?C[0]:n;if(C) C.play();} else if(A.cwObj.isFlashVideo()){A.setFlashPlayer();if (A.flsLoading(A.flsPlayer)){A.delayDone=t;theApp.SetTimeout(A.play,100,A);return;};try{if(!A.isPlaying()) A.flsPlayer.sendEvent('play');A.tryCount=0;}catch(e){var D=t;A.tryCount=(A.tryCount?A.tryCount+1:1);if(A.tryCount>30){A.tryCount=0;if(this.designTime) D=confirm(gStrings.IDS_MSG_VIDEO_STILL_LOADING);else{if (window.console) console.log("Cannot perform video operation. The video object is not ready.");D=f;}};if(D) theApp.SetTimeout(A.play,100,A);return;}} else if ((A.cwObj.supportsEvents()||B.length==0)&&theApp.is.ie) {A.setWmPlayer();if (A.wmPlayer&&A.wmPlayer.controls) A.wmPlayer.controls.play();} else if (B.length){var E=(typeof B[0].controls=='object'?B[0].controls:B[0]);if (E){if (typeof E.pause!=='undefined'){E.play();}else if (typeof E.Step!=='undefined'){var F=E.GetPluginStatus();if (!F) return;if (F.IContains('waiting')){setTimeout(function(){A.play();},100);return;};if (!F||!F.IContains('complete')) return;E.Play();}else if (typeof E.DoPause!=='undefined'){if(!A.bPlaying) E.DoPlayPause();}else{var G=A.dCon.innerHTML.replace('autostart="0"','autostart="1"');G=G.replace('<param name="autoStart" value="0"','<param name="autoStart" value="1"');A.dCon.innerHTML=G;}}};A.bPlaying=1;}};p.togglePlay=function(){var A=this;if ((!A.editMode())&&A.dCon){var B=A.dCon.getElementsByTagName('embed');if(theApp.is.useHTML5Video()) {var C=A.div.getElementsByTagName("video");C=C.length?C[0]:n;if(C) {if (A.bPlaying) C.pause();else C.play();}} else if(A.cwObj.isFlashVideo()){A.setFlashPlayer();if (A.flsLoading(A.flsPlayer)){theApp.SetTimeout(A.togglePlay,100,A);return;};A.flsPlayer.sendEvent('play');} else if ((A.cwObj.supportsEvents()||B.length==0)&&theApp.is.ie) {A.setWmPlayer();if (A.wmPlayer&&A.wmPlayer.controls) {A.setPlayState(A.wmPlayer);if (A.bPlaying) A.wmPlayer.controls.pause();else A.wmPlayer.controls.play();}} else if(B.length) {var D=(typeof B[0].controls=='object'?B[0].controls:B[0]);if (D){A.setPlayState(D);D=(typeof D.controls!=='undefined'&&D.controls!==''?D.controls:D);if (typeof D.pause!=='undefined'){if (A.bPlaying) D.pause();else D.play();}else if (typeof D.Step!=='undefined'){var E=D.GetPluginStatus();if (!E) return;if (E.IContains('waiting')){setTimeout(function(){A.togglePlay();},100);return;};if (!E.IContains('complete')) return;if (A.bPlaying) D.Stop();else D.Play();}else if (typeof D.DoPause!=='undefined'){D.DoPlayPause();}}};A.bPlaying=(A.bPlaying==1?0:1);}};p.pause=function(){var A=this;if ((!A.editMode())&&A.dCon){var B=A.dCon.getElementsByTagName('embed');if(theApp.is.useHTML5Video()) {var C=A.div.getElementsByTagName("video");C=C.length?C[0]:n;if(C) C.pause();} else if(A.cwObj.isFlashVideo()){A.setFlashPlayer();if (A.flsLoading(A.flsPlayer)){theApp.SetTimeout(A.pause,100,A);return;};if(A.isPlaying()) A.flsPlayer.sendEvent('play');} else if ((A.cwObj.supportsEvents()||B.length==0)&&theApp.is.ie) {A.setWmPlayer();if (A.wmPlayer&&A.wmPlayer.controls) A.wmPlayer.controls.pause();} else if (B.length){var D=(typeof B[0].controls=='object'?B[0].controls:B[0]);if (D){if (typeof D.pause!=='undefined'){D.pause();}else if (typeof D.Step!=='undefined'){var E=D.GetPluginStatus();if (!E||!E.IContains('complete')) return;D.Stop();}else if (typeof D.DoPause!=='undefined'){D.DoPause();}}};A.bPlaying=0;}};p.stop=function(){var A=this;if ((!A.editMode())&&A.dCon){var B=A.dCon.getElementsByTagName('embed');if(theApp.is.useHTML5Video()) {var C=A.div.getElementsByTagName("video");C=C.length?C[0]:n;if(C) C.pause();} else if(A.cwObj.isFlashVideo()){A.setFlashPlayer();if (A.flsLoading(A.flsPlayer)){theApp.SetTimeout(A.stop,100,A);return;};if(A.flsPlayer.sendEvent) A.flsPlayer.sendEvent('stop');} else if ((A.cwObj.supportsEvents()||B.length==0)&&theApp.is.ie) {A.setWmPlayer();if (A.wmPlayer&&A.wmPlayer.controls) A.wmPlayer.controls.stop();} else if (B.length) {var D=((typeof B[0].controls=='object'||typeof B[0].controls=='function')?B[0].controls:B[0]);if (D){if (typeof D.pause!=='undefined'){D.stop();}else if (typeof D.Step!=='undefined'){var E=(typeof D.GetPluginStatus!=='undefined'?D.GetPluginStatus():"complete");if (!E||!E.IContains('complete')) return;D.Stop();if (typeof D.Rewind!=='undefined') D.Rewind();}else if (typeof D.DoPause!=='undefined'){D.DoStop();}else{var F=A.dCon.innerHTML.replace('autostart="1"','autostart="0"');F=F.replace('<param name="autoStart" value="1"','<param name="autoStart" value="0"');A.dCon.innerHTML=F;}}};A.bPlaying=0;}};p.isPlaying=function(){this.setPlayState();return this.bPlaying;};p.setPlayState=function(A) {var B=this;if (!A){A=B.dCon.getElementsByTagName('embed');if (A) A=A[0];if (!A){A=B.dCon.getElementsByTagName('object');if (A) A=A[0];}};var C=jsWndVideo.getPlayState(A,n,B.cwObj.isFlashVideo());B.bPlaying=(C===n?B.bPlaying:(C?1:0));return B.bPlaying;};jsWndVideo.getPlayState=function(A,B,C) {var D=n;var E="WM";var F=n;var G=n;if(C){E='Flash';}else{if (!A) return n;if (typeof A.controls=='object') D=A.controls;if (typeof A.playState!='undefined') F=A.playState;else if (D&&typeof D.playState!='undefined') F=D.playState;else if (typeof A.GetRate!='undefined'){E="QT";var H=A.GetPluginStatus();if (!H||!H.IContains('complete')) return F;F=A.GetRate();}else if (D&&typeof D.GetRate!='undefined'){E="QT";var H=D.GetPluginStatus();if (!H||!H.IContains('complete')) return F;F=D.GetRate();}else if (typeof A.GetPlayState!='undefined'){E="Real";F=A.GetPlayState();}else if (D&&typeof D.GetPlayState!='undefined'){E="Real";F=D.GetPlayState();}};if (E=='WM'&&F!==n) {switch (F){case 2:G=(B)?t:f;break;case 0:case 1:case 6:case 7:case 8:case 9:case 10:G=f;break;case 3:case 4:case 5:G=t;break;}}else if (E=='QT'&&F!==n){if (F==0) G=f;else G=t;}else if (E=='Real'&&F!==n){switch (F){case 0:case 4:G=f;break;case 1:case 2:case 3:case 5:G=t;break;}}else if(E=='Flash'){var J=n;if (A){if (A.wndObj) J=A.wndObj;else if (A.parentNode&&A.parentNode.wndObj) J=A.parentNode.wndObj;};G=J&&(J.playerState=='PLAYING'||J.playerState=='BUFFERING')?t:f;};return G;};p.setFlashPlayer=function(){if (this.flsPlayer) return;if (theApp.is.ie) {this.flsPlayer=document['swf'+this.name];} else {var A=this.dCon.getElementsByTagName('object');if (A&&A.length>0) this.flsPlayer=(theApp.is.Mac?A[0]:A[0].getElementsByTagName('embed')[0]);}};p.setWmPlayer=function(){if (this.wmPlayer) return;if (theApp.is.ie) {this.wmPlayer=document[this.name+'obj'];} else {var A=this.dCon.getElementsByTagName('object');if (A&&A.length>0) this.wmPlayer=(theApp.is.Mac?A[0]:A[0].getElementsByTagName('embed')[0]);}};p.actionMute=function(){if (!this.editMode()) return this.mute();};p.actionUnMute=function(){if (!this.editMode()) return this.unMute();};p.mute=function(){var A=this;if ((!A.editMode())&&A.dCon){if(theApp.is.useHTML5Video()){var B=A.div.getElementsByTagName("video");B=B.length?B[0]:n;if(B) B.muted=t;}else if(A.cwObj.isFlashVideo()){A.setFlashPlayer();if (A.flsLoading(A.flsPlayer)){theApp.SetTimeout(A.mute,100,A);return;};if(A.flsPlayer.sendEvent) A.flsPlayer.sendEvent('MUTE','true');}}};p.unMute=function(){var A=this;if ((!A.editMode())&&A.dCon){if(theApp.is.useHTML5Video()){var B=A.div.getElementsByTagName("video");B=B.length?B[0]:n;if(B) B.muted=f;}else if(A.cwObj.isFlashVideo()){A.setFlashPlayer();if (A.flsLoading(A.flsPlayer)){theApp.SetTimeout(A.unMute,100,A);return;};if(A.flsPlayer.sendEvent) A.flsPlayer.sendEvent('MUTE','false');}}};function jsWndDocument(){jsWndObj.prototype.constructor.call(this);};p=jsWndDocument.prototype=new jsWndObj();p.constructor=jsWndDocument;p.attach=function(A){jsWndObj.prototype.attach.call(this,A);this.dCon=this.div.getElementsByTagName('IFRAME')[0];};p.changeContents=function(A){if (this.dCon) this.dCon.src=this.designTime?A.getLink():A;};function jsWndRefList(){jsWndObj.prototype.constructor.call(this);};p=jsWndRefList.prototype=new jsWndObj();p.constructor=jsWndRefList;function jsWndIpix(){jsWndObj.prototype.constructor.call(this);};p=jsWndIpix.prototype=new jsWndObj();p.constructor=jsWndIpix;function jsWndOther(){jsWndObj.prototype.constructor.call(this);};p=jsWndOther.prototype=new jsWndObj();p.constructor=jsWndOther;p.attach=function(A){var B=this,C=B.rcdGetAttData(),D=C.objData,E=B.cwObj?B.cwObj.arChld:[];if (C){jsWndObj.prototype.attach.call(B,A);if (!B.cwObj.arChld||!B.cwObj.arChld.length) B.cwObj.arChld=E;if(B.div){var F=B.div.style;F.left=B.rtRect.x+'px';F.top=B.rtRect.y+'px';F.width=B.rtRect.width+'px';F.height=B.rtRect.height+'px';F.clip="rect(0,"+F.width+","+F.height+", 0)";}}else{if (!B.cwObj) B.cwObj={};if (D&&D.a){var G=D.a;B.actFlags=G[0];B.dwFlags=G[1];};B.parPage=trivPage;};trivArExec(B.arChld,function(o){if (!o.cwObj) o.cwObj={};o.cwObj.par=B;});};p.moveGrp=function(A,B){var C=9999;var D=9999;var E=this.arChld;var x,y;if (E) for(var i=0;i<E.length;i++){if (!E[i].div) continue;x=E[i].div.offsetLeft;y=E[i].div.offsetTop;if(x<C)C=x;if(y<D)D=y;};if (E) for(var i=0;i<E.length;i++){if (!E[i].div) continue;x=E[i].div.offsetLeft;y=E[i].div.offsetTop;E[i].moveTo(x-(C-A),y-(D-B));E[i].bHasMoved=t;}};p.transGrp=function(A,B,C,x,y,D,E){var F='notset',G=n;x=parseInt(x);y=parseInt(y);trivArExec(this.arChld,function(J){if (!J.div) return;var H=J.div.offsetLeft;var I=J.div.offsetTop;if (F=='notset') {F=H;G=I;};if(F>H) F=H;if(G>I) G=I;});trivArExec(this.arChld,function(K){if (!K.div) return;H=K.div.offsetLeft;I=K.div.offsetTop;doDivTrans(A,K.div,B,C,n,K,x+(H-F),y+(I-G),E);});};p.offset=function(A) {var B=0;var C=this.arChld;if (C){C.sort(function(a,b) { return (a.rtRect&&b.rtRect)?a.rtRect.y-b.rtRect.y:0;});for (var i=0;i<C.length;i++){var D=C[i];if (!D.div) continue;D.div.style.top=String(D.div.offsetTop+A)+"px";var E=D.div.offsetHeight;if (D instanceof jsWndText){D.div.style.height=D.dCon2.offsetHeight+'px';var F=D.div.offsetHeight-E;if (F>0) A+=F;};var G=D.div.offsetTop+D.div.offsetHeight;if(B<G) {B=G;}}};return B;};p.show=function(){if (this.div) return jsWndObj.prototype.show.call(this);trivArExec(this.arChld,function(o){if (o.show) o.show();if (o.matchLine) o.matchLine.style.visibility='visible';});};p.hide=function(){if (this.div) return jsWndObj.prototype.hide.call(this);trivArExec(this.arChld,function(o){if (o.hide) o.hide();if (o.matchLine) o.matchLine.style.visibility='hidden';});};p.toggleVisibility=function(){if (this.div) return jsWndObj.prototype.toggleVisibility.call(this);trivArExec(this.arChld,function(o){if (o.toggleVisibility) o.toggleVisibility();});};p.pubRGUpdate=function(){var A=this.cwObj.formVar.getValue();trivArExec(this.arChld,function(o){if (o.constructor===jsWndFormRadio) o.setCheck(o.dCtrl.value==A);});};p.updateDiv=function(){};function jsWndMenu(){jsWndObj.prototype.constructor.call(this);};p=jsWndMenu.prototype=new jsWndObj();p.constructor=jsWndMenu;p.attach=function(A){var i;var B=this;var C=B.rcdGetAttData();var D=C.objData;var E=C.htmlId;jsWndObj.prototype.attach.call(B,A);var F=B.cwObj;F.textColor=D.textColor;F.bgHLColor=D.bgHLColor;F.textHLColor=D.textHLColor;F.bgColor=D.bgColor;F.resBgImg=D.resBgImg;var G=[];F.arItems=G;F.res=D.res;F.resNotStarted=D.resNotStarted;F.resInProgress=D.resInProgress;var H={};H.textColor=D.subTextColor;H.bgHLColor=D.subBgHLColor;H.textHLColor=D.subTextHLColor;H.bgColor=D.subBgColor;H.resBgImg=D.subResBgImg;F.subMenu=H;B.div.tObj=B;B.div.bMain=1;var I=document.getElementsByTagName("DIV");var J=[];var K=new RegExp("^[^0-9]*([0-9]*)");K.test(E);var L=RegExp.$1;K=new RegExp("^(tmenu|item)"+L+".*$");for (i=0;i<I.length;i++) if (K.test(I[i].id)) J.push(I[i]);var M;var N=new RegExp("^item("+L+".*)$");for (i=0;i<J.length;i++){M=J[i];var O=document.compatMode=="BackCompat";if (O&&theApp.is.ie10orLess){var w=M.style.width,h=M.style.height;if (w) w=w.substring(0,w.length-2);if (h) h=h.substring(0,h.length-2);if (!isNaN(w)) M.style.width=(parseInt(w)+2)+'px';if (!isNaN(h)) M.style.height=(parseInt(h)+2)+'px';};if (N.test(M.id)){G.push({id:M.id,div:M,attached:t});}};for (i=0;i<G.length;i++){curNode=((G[i]&&G[i].div)?G[i].div.parentNode:n);while (curNode&&curNode.tagName=="DIV"){if (curNode.id&&curNode.id.indexOf("tobj")==0) { G[i].div.bSub=0;break;}else if (curNode.id&&curNode.id.indexOf("tmenu")==0) { G[i].div.bSub=1;break;};curNode=curNode.parentNode;}};var P=new RegExp("^tmenu("+L+".*)$");for (i=0;i<J.length;i++){M=J[i];if (P.test(M.id)){var Q=new jsPopMenu(B);Q.div=M;M.popM=Q;for (var j=0;j<G.length;j++){var R=G[j];if (R.id=="item"+RegExp.$1){R.popMenu=Q;break;}}}};if(A) B.updateIndicators();};p.updateDiv=function(){jsWndObj.prototype.updateDiv.call(this);var A=this.rcdGetAttData(),B=document.getElementById('wndPage'),C=document.getElementById('menuAddlHtml_'+A.htmlId);if (!C){C=document.createElement('div');C.setAttribute('id','menuAddlHtml_'+A.htmlId);B.appendChild(C);}else C.innerHTML='';if (A.additionalHtml) C.innerHTML=A.additionalHtml;};p.updateIndicators=function(){jsWndObj.prototype.updateIndicators.call(this);jsWndObj.prototype.updateIndicators.call(this,document.getElementById('menuAddlHtml_'+this.div.id).getElementsByTagName('IMG'));};p.mouseDown=function(e){if(this.editMode()) return jsWndObj.prototype.mouseDown.call(this,e);else menuMouseDown(e,this);};p.mouseUp=function(e){if(this.editMode()) return jsWndObj.prototype.mouseUp.call(this,e);else menuMouseUp(e,this);};p.mouseMove=function(e){if(this.editMode()) return jsWndObj.prototype.mouseMove.call(this,e);else menuMouseMove(e,this);};p.mouseEnter=function(){if(!this.editMode()) menuMouseEnter(this);};p.mouseExit=function(){if(!this.editMode()) menuMouseExit(this);};function menuMouseMove(e,A){var B=n;var C=A.cwObj;if(e.target) B=e.target;else if(e.srcElement) B=e.srcElement;while(B){if(B&&B.id&&B.id.indexOf('item')==0) break;B=B.parentNode;};if(B){var D=menuFindItemByID(B.id,C.arItems);var E;if(D){D.div=B;if(A.currItem!=D){E=B.bSub&&B.bSub!=0;var F=E?C.subMenu:C;B.style.backgroundColor=((F.bgHLColor==-1||F.bgHLColor=='')?'transparent':F.bgHLColor);B.style.color=F.textHLColor;if(D.arrow) menuChangeArrowColor(B,F.textHLColor);if(A.currItem&&A.currItem.div){E=A.currItem.div.bSub&&A.currItem.div.bSub!=0;var G=E?C.subMenu:C;A.currItem.div.style.backgroundColor=((G.bgColor==-1||G.bgColor==''||G.resBgImg)?'transparent':G.bgColor);A.currItem.div.style.color=G.textColor;if(A.currItem.arrow) menuChangeArrowColor(A.currItem.div,G.textColor);};var H=A.currPopMenu;if(H&&H!=D.popMenu){H.hide();H=0;};if(D.popMenu){D.popMenu.show(A);A.currPopMenu=D.popMenu;};A.currItem=D;}}}};function findItemDiv(e,A){var B=(e.target)?B=e.target:(e.srcElement)?e.srcElement:n;while(B){if(B&&B.id&&B.id.indexOf('item')==0) break;B=B.parentNode;};return B;};function hideSubMenus(A,B){if((B instanceof jsPopMenu)&&(B.isDescendantOf(A))){B.toggleView();}else hideSubMenu(A);};function topWndMenu(A){if(A&&A.par) return topWndMenu(A.par);else return A;};function hideSubMenu(A){if(A.currPopMenu){A.currPopMenu.hide();A.currPopMenu=0;return t;}};function toggleSubMenu(A,B){if(!hideSubMenu(A)){showSubMenu(A,B);}};function showSubMenu(A,B){if(B&&B.popMenu){if(A.currPopMenu&&A.currPopMenu!==B.popMenu) hideSubMenu(A);A.currPopMenu=B.popMenu;};if(A.currPopMenu) A.currPopMenu.show(A);};function resetMenus(A,B){for(var i=0,C=B.length;i<C;i++){if(B[i] instanceof jsWndMenu){var D=A&&(A instanceof jsPopMenu)&&(A.isDescendantOf(B[i]));if(B[i]!==A&&!D){hideSubMenus(B[i],A);}}}};function menuMouseEnter(A){A.mouseIn=1;};function menuMouseExit(A){if(A&&A.mouseIn){var B=A.currItem.div.bSub&&A.currItem.div.bSub!=0;var C=B?A.cwObj.subMenu:A.cwObj;var D=A.currItem.div.style;D.backgroundColor=((C.bgColor==-1||C.bgColor==''||C.resBgImg)?'transparent':C.bgColor);D.color=C.textColor;if(A.currItem.arrow) menuChangeArrowColor(A.currItem.div,C.textColor);};A.currItem=0;A.mouseIn=0;};function menuMouseDown(e,A){A.bLButtonDown=1;};function menuMouseUp(e,A){try{if (A.bLButtonDown){var B=findItemDiv(e,A);if(B){var C=menuFindItemByID(B.id,A.cwObj.arItems);if(C&&!C.bSep){C.div=B;var D=topWndMenu(A);if(!C.attached) D.parPage.doAction(C.actItem,n,A);if(A.currItem===C) toggleSubMenu(A,C);else showSubMenu(A,C);}}}} finally{A.bLButtonDown=0;}};function menuFindItemByID(A,B){for(var i=0;i<B.length;i++){var C=B[i];if(C.id==A) return C;if(C.arItems){C=menuFindItemByID(A,C.arItems);if(C) return C;}};return n;};function menuChangeArrowColor(A,B){A=A.nextSibling;for(var i=0;i<4;i++){if(!A) break;A.style.backgroundColor=B;A=A.nextSibling;}};function jsPopMenu(A){var B=this;B.par=A;B.mouseIn=0;B.timer=0;B.currItem=0;B.currPopMenu=0;B.cwObj=A.cwObj;};p=jsPopMenu.prototype=new jsWndObj();p.constructor=jsPopMenu;p.show=function(A){var B=this;if (A) B.par=A;B.div.style.visibility='visible';B.timer=setTimeout(function(){B.menuTimeOut();},1000);};p.hide=function(){if(this.currPopMenu) this.currPopMenu.hide();this.div.style.visibility='hidden';this.par.currPopMenu=0;if(this.timer) clearTimeout(this.timer);this.timer=0;};p.toggleView=function(){if(this.par.currPopMenu) this.hide();else this.show();};p.isDescendantOf=function(A){if(this.par) if(this.par instanceof jsWndMenu) return this.par===A&&this.par.currPopMenu===this;else if(this.par instanceof jsPopMenu) return this.par===A||this.par.isDescendantOf(A);};p.menuTimeOut=function(){var A=this;if(!A.div||A.div.style.visibility!='visible') return;if(!A.mouseIn&&!A.par.mouseIn&&!A.currPopMenu){A.div.style.visibility='hidden';A.par.currPopMenu=0;}else A.timer=setTimeout(function(){A.menuTimeOut();},1000);};p.mouseEnter=function(){menuMouseEnter(this);};p.mouseMove=function(e){menuMouseMove(e,this);};p.mouseExit=function(){menuMouseExit(this);};p.mouseDown=function(e){menuMouseDown(e,this);};p.mouseUp=function(e){menuMouseUp(e,this);};function jsWndTOC(){jsWndObj.prototype.constructor.call(this);};p=jsWndTOC.prototype=new jsWndObj();p.constructor=jsWndTOC;p.attach=function(A){var B=this,C=B.rcdGetAttData().objData;jsWndObj.prototype.attach.call(B,A);var D=(C&&C.iAppear==2)?'SELECT':'DIV';B.dCon=B.div.getElementsByTagName(D)[0];B.res=C.res;B.resNotStarted=C.resNotStarted;B.resInProgress=C.resInProgress;if (A) B.updateIndicators();};p.expand=function(A,B,C,D){if ((!A||A.tagName!='IMG')&&D){var E=document.getElementById(D);var F=(E?E.childNodes:n);if (E) for (var i=0;i<F.length;i++){if (F[i].id=='expandImg'){A=F[i];break;}}};if (!A||A.tagName!='IMG') return;if(A.style.visibility=='hidden')return;var G=A.parentNode.parentNode;if(A.src.indexOf(B)>=0){A.src=A.src.replace(B,C);var H=G.getElementsByTagName('UL')[0];H.style.display='block';}else if(A.src.indexOf(C)>=0){A.src=A.src.replace(C,B);G.getElementsByTagName('UL')[0].style.display='none';}};p.scrollTo=function(A){if(!this.div) return;var B=n;var C=this.div.getElementsByTagName('DIV');if (C) for(var D=0;D<C.length;D++) {if(C[D]&&(C[D].id=='toc'||C[D].className=='DLG_treeview')){B=C[D];break;}};if(!B) return;var E='trivExitPage("'+A;var F=B.getElementsByTagName('LI');if(!F||!F.length) F=B.getElementsByTagName('P');if(!F) return;for(var D=F.length-1;D>=0;D--){var H=F[D];if(H.className=='DLG_selected'||H.innerHTML.indexOf(E)>-1){var I=H.offsetTop;if(I<5) I=0;else if (theApp.is.ie10orLess&&H.tagName=='P'){if((I+H.scrollHeight)>(B.scrollTop+B.clientHeight)||I<B.scrollTop){I+=H.scrollHeight;I-=B.clientHeight;}else I=0;};if(I) B.scrollTop=I;break;}}};function jsWndProgressBar(){jsWndObj.prototype.constructor.call(this);this.barPos=0;this.step=0;this.range=0;};p=jsWndProgressBar.prototype=new jsWndObj();p.constructor=jsWndProgressBar;p.attach=function(A){var B=this,C=B.rcdGetAttData().objData;jsWndObj.prototype.attach.call(B,A);var D=B.cwObj;B.dCon=B.div.getElementsByTagName('DIV')[0];B.dBkgnd=B.dCon.getElementsByTagName('DIV')[0];B.dBar=B.dBkgnd.getElementsByTagName('DIV')[0];B.step=C.step;B.range=C.range;B.barPos=C.barPos;D.tickTime=C.tickTime;D.dwBarFlags=C.dwBarFlags;if (D.dwBarFlags&0x20&&D.dwBarFlags&0x8) B.play();};p.stepIt=function(A){if(A==undefined||A==""||A=="0") return this.setBarPosition(Number(this.barPos)+Number(this.step));else return this.setBarPosition(Number(this.barPos)-Number(this.step));};p.setPosition=function(A){if(this.cwObj.dwBarFlags&0x10) return this.setBarPosition(A);};p.isPlaying=function(){return ((this.cwObj.dwBarFlags&0x8)&&this.timer);};p.play=function(){var A=this;if(!A.cwObj.dwBarFlags&0x8) return 0;else if(A.timer) return A.barPos;else{A.timer=setTimeout(function(){A.onTimer();},A.cwObj.tickTime);return 1;}};p.stop=function(){var A=this;A.pause();A.setBarPosition(0);return 0;};p.pause=function(){var A=this;if(!A.cwObj.dwBarFlags&0x8) return 0;else if(A.timer){clearTimeout(A.timer);A.timer=0;};return A.barPos;};p.togglePlay=function(){if(this.isPlaying()) this.pause();else this.play();};p.onTimer=function(){var A=this;if(A.stepIt("0")>=A.range){A.timer=0;if(A.actFlags&0x40) A.issueActions(6);}else A.timer=setTimeout(function(){A.onTimer();},A.cwObj.tickTime);};p.setBarPosition=function(A){A=parseInt(A);if(typeof A!='number'||isNaN(A)) A=0;var B=this;if(A>B.range) A=B.range;else if(A<0) A=0;B.barPos=A;var C=A/B.range;var D=B.cwObj.dwBarFlags;var E=B.dBar.style;if(D&0x1){C*=B.rtRect.height;C=Math.round(C);if(D&0x80) C=B.rtRect.height-C;E.left='0px';E.top=(B.rtRect.height-C)+'px';E.width='100%';E.height=C+'px';}else{C*=B.rtRect.width;C=Math.round(C);if(D&0x80) C=B.rtRect.width-C;E.left='0px';E.top='0px';E.width=C+'px';E.height='100%';};if(B.cwObj&&B.cwObj.pbVar!=null) B.cwObj.pbVar.set(A.toString());return A;};jsWndProgressBar.prototype.createBarImgs=function(){var A=this;var B=A.cwObj.dwBarFlags;var C=A.dBar.getElementsByTagName('img');for(var i=0;i<C.length;i++) A.dBar.removeChild(C[i]);if(A.bImg){var D=B&0x1?A.rtRect.height:A.rtRect.width;var E=B&0x1?A.bImg.height:A.bImg.width;for(var i=0;i<D;i+=E){var F=document.createElement('img');F.src=A.bImg.src;F.style.position='absolute';if(B&0x1){F.style.left='0px';F.style.top=i+'px';F.style.width='100%';F.style.height=A.bImg.height+'px';}else{F.style.left=i+'px';F.style.top='0px';F.style.width=A.bImg.width+'px';F.style.height='100%';};A.dBar.appendChild(F);}}};function jsWndStatusIndicator(){jsWndObj.prototype.constructor.call(this);};p=jsWndStatusIndicator.prototype=new jsWndObj();p.constructor=jsWndStatusIndicator;p.attach=function(A){var B=this,C=B.rcdGetAttData().objData;jsWndObj.prototype.attach.call(B,A);B.dCon=B.div.getElementsByTagName('IMG')[0];B.res=C.res;B.resNotStarted=C.resNotStarted;B.resInProgress=C.resInProgress;if (A) B.updateIndicator(B.status);};p.changeContents=function(A){if (this.dCon){if(A==n){this.dCon.style.visibility='hidden';return;};this.dCon.style.visibility='';var B=this.designTime?A.getLink():A;if (!this.designTime&&theApp.is.ie6){if (this.dCon.src.indexOf('.png')==this.dCon.src.length-4){this.div.style.filter='';this.dCon.style.filter='';};if (B.indexOf('.png')==B.length-4){this.div.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+B+"',sizingMethod='scale')";this.dCon.style.filter='progid:DXImageTransform.Microsoft.Alpha(opacity=0)';}};this.dCon.src=B;}};p.updateIndicator=function(A){var B=this;B.status=A;if(A=="notstarted") B.changeContents(B.resNotStarted);else if(A=="inprogress") B.changeContents(B.resInProgress);else B.changeContents(B.res);};function jsWndForm(){};jsWndForm.prototype.attach=function(A){var B=this.rcdGetAttData().objData;jsWndObj.prototype.attach.call(this,A);var C=this.cwObj;C.objType=11;C.formType=B.formType;C.dwFormFlags=B.dwFormFlags;};function jsWndFormEntry(){jsWndObj.prototype.constructor.call(this);};p=jsWndFormEntry.prototype=new jsWndObj();p.constructor=jsWndFormEntry;p.numberOnlyKeyPressedHandler=function(A) {if (!A) A=window.event;var B=A.target?A.target:A.srcElement;var C=A.keyCode||A.which;var D=B.value;if(A.which!==undefined&&(A.which===0||A.which===8)){return;}else if(C===46){if(!D){ B.value='0';};if(D==='-'){ B.value='-0';}else if(D.indexOf('.')!=-1){ cancelEvent(A);}}else if(C===43&&D.indexOf('-')===0){B.value=D.substr(1);}else if(C===45){if(D){if(D.indexOf('-')===-1){ B.value='-'+D;};cancelEvent(A);}}else if(C===44){if(!D){ B.value='0';};if(D==='-'){ B.value='-0';}else if(D.indexOf('.')!=-1){ cancelEvent(A);}else if(D.slice(-1)===','){ cancelEvent(A);}}else if(C<48||C>57) {cancelEvent(A);}};p.attach=function(A){var B=this,C=B.rcdGetAttData().objData;jsWndForm.prototype.attach.call(B,A);var D=B.div.getElementsByTagName('textarea');B.dCon=(D&&D.length?D[0]:B.div.getElementsByTagName('input')[0]);B.cwObj.iNumChars=C.iNumChars;};p.update=function(A,B,C,D){var E=this;if (!E.trivAlert){var F=E.dCon;if (F.value.length>B){if (D&&trivAlert){E.trivAlert=t;trivAlert(D,'',C,function(){E.trivAlert=f;var G=F.onpropertychange;F.onpropertychange=n;try{F.value=F.value.substring(0,B);if (F.value.length>B) F.value=F.value.replace(/\r\n$/,'');}finally{F.onpropertychange=G;}});F.blur();}else{alert(C);F.focus();};F.value=F.value.substring(0,B);return f;};A.set(F.value);}};p.changeContents=function(A){this.dCon.value=A;if(this.cwObj.formVar) this.cwObj.formVar.set(A);};p.reset=function(){this.dCon.value=this.cwObj.strDefValue;this.onChange();};p.updateDiv=function(){var A=n,B=n,C=n,D=this.dCon;if (D){A=this.rcdGetAttData().innerHtml;B=document.createElement("div");B.innerHTML=A;C=B.getElementsByTagName(D.tagName)[0];};jsWndObj.prototype.updateDiv.call(this,(D?t:f));if (C) D.style.cssText=C.style.cssText;A=n;B=n;C=n;};function jsWndFormRadio(){jsWndObj.prototype.constructor.call(this);};p=jsWndFormRadio.prototype=new jsWndObj();p.constructor=jsWndFormRadio;p.attach=function(A){var B=this,C=false,D=B.rcdGetAttData().objData;if (A) C=(B.dCtrl?B.dCtrl.checked:false);jsWndForm.prototype.attach.call(B,A);B.name=D.htmlId;var E=B.div.getElementsByTagName('DIV')[0];B.dCon=E;B.dCtrl=E.getElementsByTagName('INPUT')[0];B.dLbl=E.getElementsByTagName('LABEL')[0];if (A) this.dCtrl.checked=C;};p.setCheck=function(A){var B=this;B.dCtrl.checked=A;var C=!B.bHSTransparent&&(this.cwObj.formType==1?(A?theApp.cr_on:theApp.cr_off):(A?theApp.cc_on:theApp.cc_off));if (C)	B.dLbl.style.backgroundImage="url('"+C+"')";};p.getCheck=function(){return this.dCtrl.checked;};p.changeContents=function(A){this.setCheck(A&&A.length);if(this.cwObj.formVar) this.cwObj.formVar.set(A);};p.reset=function(A){this.setCheck(this.cwObj.dwFormFlags&0x2);if(!A) this.onChange();};p.onClick=function(e){this.setCheck(this.cwObj.formType==1?1:this.dCtrl.checked);if(this.designTime) return this.onChange();};function jsWndFormList(){jsWndObj.prototype.constructor.call(this);};p=jsWndFormList.prototype=new jsWndObj();p.constructor=jsWndFormList;p.attach=function(A){var B=this,C='';if (A) C=(B.dCon?B.dCon.value:'');jsWndForm.prototype.attach.call(B,A);var D=B.div.getElementsByTagName('SELECT')[0];B.dCon=D;if (A) B.dCon.value=C;};p.changeContents=function(A){this.setSel(A);if(this.cwObj.formVar) this.cwObj.formVar.set(A);};p.reset=function(A){var B=this;var C=-1;if (B.cwObj.arItems) for(var i=0;i<B.cwObj.arItems.length;i++){var D=B.cwObj.arItems[i];if(!A&&D.bSel){if(B.cwObj.dwFormFlags&0x20) B.dCon.options[i].selected=t;else C=i;}else if(B.cwObj.dwFormFlags&0x20) B.dCon.options[i].selected=f;};if(!(B.cwObj.dwFormFlags&0x20)) B.dCon.selectedIndex=C;if (B.onChange) B.onChange();};p.setSel=function(A){var B=this.dCon.options;if (!A||A=="~~~null~~~"){this.dCon.value='';this.reset(t);return;};if(this.cwObj.dwFormFlags&0x20){for(var i=0;i<B.length;i++){var C=new RegExp("(?:^|[,])"+B[i].label+"(?:$|[,])");if (C.test(A)) B[i].selected=t;else B[i].selected=f;}}else{this.dCon.value=A;}};p.getSel=function(){if(this.cwObj.dwFormFlags&0x20){var A='';var B=this.dCon.options;for(var i=0;i<B.length;i++) if(B[i].selected) A+=(A.length==0?'':',')+B[i].label;return A;}else return this.dCon.value;};function jsWndTestTimer(){jsWndObj.prototype.constructor.call(this);};p=jsWndTestTimer.prototype=new jsWndObj();p.constructor=jsWndTestTimer;p.changeContents=function(A){if (this.div) (this.div.getElementsByTagName('DIV')[0]).innerHTML=A;};p.attach=function(A){var B=this,C=B.rcdGetAttData().objData;jsWndObj.prototype.attach.call(B,A);var D=B.cwObj;D.dwTimerFlags=C.dwTimerFlags;D.iTimerTime=C.iTimerTime;D.name=C.publishName;D.id=C.id;D.timerVar=window["Var"+C.timerVarName];D.bAutoStart=C.bAutoStart;B.dCon=B.div.getElementsByTagName('DIV')[0];};p.play=function() {var A=this;if(A.cwObj.timerVar!=null) var B=A.cwObj.timerVar.getValue();if ((A.cwObj.timerVar.getValue().indexOf("pause:")!=-1)) B=parseInt(B.split(':')[1]);A.cwObj.timerVar.set((parseInt((new Date().getTime()+500)/1000)*1000)-B);};p.pause=function() {var A=this;if(A.cwObj.timerVar!=null&&!(A.cwObj.timerVar.getValue().indexOf("pause:")!=-1)) var B=A.cwObj.timerVar.getValue();if(B&&B!="NaN") A.cwObj.timerVar.set('pause:'+((parseInt((new Date().getTime()+500)/1000)*1000)-B));};p.stop=function(){var A=this;if(A.cwObj.timerVar!=null) A.cwObj.timerVar.set("pause:0");};p.onDone=function() {var A=this.designTime?wndPage:trivPage;trivArExec(this.cwObj.arChld,function(o,i){if (o.type==6&&o.on==6) A.doAction(o.actItem,o.elseItem,o);});};p.togglePlay=function() {if(window[this.cwObj.timerVar]!=null){var A=window[this.cwObj.timerVar].getValue();if(typeof(A)=="string"&&A.indexOf('pause:')!=-1) this.play();else this.pause();}};jsWndTestTimer.trivTimerLoop=function(A,B,C,D,E,F){var G=A.getValue();var H=parseInt(G);var I=false;var J=parseInt((new Date().getTime()+500)/1000)*1000;if(typeof(G)=="string"){var K=G.indexOf("pause:")!=-1;var L=G.indexOf("done:")!=-1;if(K||L){var M=parseInt(G.split(':')[1]);H=(J-M);if(K) I=true;else{if(F) I=true;else A.set(H);}}};if((H==0||H>J)&&!I){H=J;A.set(H);};var N=eval(E);var O=jsWndTestTimer.getRemainingTime(J,H,B*1000,N.bShowHours,N.bShowMin,N.bShowSec,N.countdown);if(O==null&&!I){A.set("pause:-999999999999999");eval(C);}else{if(O==null) O=jsWndTestTimer.buildTimeString((N.countdown)?0:(B*1000),N.bShowHours,N.bShowMin,N.bShowSec);var P=eval(D);P(O);};var Q="jsWndTestTimer.trivTimerLoop("+A.name+","+B+",'"+C+"','"+D+"', '"+E+"', true )";setTimeout(Q,500);};jsWndTestTimer.getRemainingTime=function(A,B,C,D,E,F,G){B=parseInt(B/1000)*1000;var H=0;var I=0;var J=0;var A=parseInt((new Date().getTime()+500)/1000)*1000;if(B>A) return null;J=A-B;H=C-J;if (!G){I=C-H;if (I>C) return null;H=I;};if(G&&H>0||!G&&I<C) return jsWndTestTimer.buildTimeString(H,D,E,F,G);else return null;};jsWndTestTimer.buildTimeString=function(A,B,C,D){var E='';A=A/1000;var F=parseInt(A/3600);A-=F*3600;if (B){E+=F+':';}else E+='  ';F=parseInt(A/60);A-=F*60;if (C){if(F<=9) E+='0';E+=F;};if (D){if (C) E+=':';if(A<=9) E+='0';E+=parseInt(A);};return E;};function jsWndText(){jsWndObj.prototype.constructor.call(this);};p=jsWndText.prototype=new jsWndObj();p.constructor=jsWndText;p.attach=function(A){var B=this,C=B.rcdGetAttData().objData;jsWndObj.prototype.attach.call(B,A);B.dCon=0;B.dCon2=0;trivArExec(B.div.getElementsByTagName('DIV'),function(E){var D=E.getAttribute("name");if (D=="dCon") B.dCon=E;else if (D=="dCon2") B.dCon2=E;if (B.dCon&&B.dCon2) return f;});B.cwObj.dwTextFlags=C.dwTextFlags;B.cwObj.borderSize=C.borderSize;B.cwObj.marginSize=C.marginSize;if (B.__newContent) B.changeContents(B.__newContent);};p.changeContents=function(A,B){var C=this;var D=C.dCon2;if (D==n||C.inWriteContent) {if (!B||B<10) setTimeout(function(){C.changeContents(A,(B?++B:1));},200);return;};A=A=="~~~null~~~"?"":A;C.__newContent=A;A=(A&&A.replace?A.replace(/\n/g,"<br>"):A);var E=jsWndText.getFirstTextNode(D);if (E) {var F=[];while (E.parentNode!=D) {E=E.parentNode;F[F.length]=E;};if (F.length) {removeAllChildren(D,F);while (F[0].tagName&&F[0].tagName.toUpperCase()=="SPAN"&&!F[0].style.backgroundColor&&!F[0].style.fontFamily&&!F[0].style.fontSize&&!F[0].style.color){F[1].removeChild(F[0]);F.shift();};F[0].innerHTML=A;}else E=null;};if (!E) D.innerHTML='<p style="text-align:left"><span style="font-size:12pt;color:#000000;font-family:Arial,sans-serif">'+A+'</span></p>';};p.sizeTo=function(w,h){var A=this;var B=A.cwObj.borderSize;var C=A.cwObj.marginSize;var D=(this.cwObj.dwTextFlags&0x8?2:0);var E=B*2+D;if (w<E) w=E;if (h<E) h=E;A.rtRect.width=w;A.rtRect.height=h;A.div.style.width=w+'px';A.div.style.height=h+'px';A.setdConWidth();A.setdConHeight();var F=(B+C)+'px';A.dCon2.style.left=F;A.dCon2.style.top=F;A.setTxtWidth(A.dCon2);A.setTxtHeight(A.dCon2);if (B){var G=(h-E)+'px';var H=(w-E)+'px';var I=(h-B-D)+'px';var J=(w-B-D)+'px';var K=A.dCon.getElementsByTagName("DIV");for(var i=0;i<K.length;i++) {var L=K[i].id;if (L){if (L=='tbbt') K[i].style.width=H;else if (L=='tbbb'){K[i].style.width=H;K[i].style.top=I;}else if (L=='tbbl') K[i].style.height=G;else if (L=='tbbr'){K[i].style.height=G;K[i].style.left=J;}else if (L=='tbbbl') K[i].style.top=I;else if (L=='tbbtr') K[i].style.left=J;else if (L=='tbbbr'){K[i].style.left=J;K[i].style.top=I;}}}}};p.setdConWidth=function(){var w=(this.rtRect.width-(this.cwObj.dwTextFlags&0x8?2:0));this.dCon.style.width=(w<0?0:w)+'px';};p.setdConHeight=function(){var h=(this.rtRect.height-(this.cwObj.dwTextFlags&0x8?2:0));this.dCon.style.height=(h<0?0:h)+'px';};p.setTxtWidth=function(A){var w=(this.rtRect.width-this.cwObj.borderSize*2-this.cwObj.marginSize*2);A.style.width=(w<0?0:w)+'px';};p.setTxtHeight=function(A){var h=(this.rtRect.height-this.cwObj.borderSize*2-this.cwObj.marginSize*2);A.style.height=(h<0?0:h)+'px';};jsWndText.getFirstTextNode=function(A){if (A){if(A.nodeType==3&&A.nodeValue!="\n") return A;else{for(var j=0;j<A.childNodes.length;j++){var B=jsWndText.getFirstTextNode(A.childNodes[j]);if(B) return B;}}};return n;};function jsRcdAttachData(){this.att_Desktop=n;this.att_TabletLandscape=n;this.att_TabletPortrait=n;this.att_PhoneLandscape=n;this.att_PhonePortrait=n;};function jsRcdState(){this.firedActions=0;this.visibility=n;};function jsFlashHandler(){};jsFlashHandler.FlashStateChange=function(A){if(A&&A.id&&A.newstate){var B=document.getElementById(A.id);if(B&&B.wndObj){B.wndObj.playerState=A.newstate;if(B&&A.newstate=='COMPLETED') {B.wndObj.onDone();B.wndObj.clearEventsFlag(-1);}}}};jsFlashHandler.FlashTimeChange=function(A){if(A&&A.id&&A.position&&A.duration){var B=document.getElementById(A.id);if(B&&B.cwObj){var C=B.cwObj.arEvents;if(C&&C.length>0) {for(var i=0;i<C.length;i++){var D=Number(C[i].value)/1000;if (!C[i].proc&&A['position']>=D&&A['position']<=A['duration']) {C[i].proc=true;B.wndObj.onEvent(C[i].name);}};B.wndObj.clearEventsFlag(A['position']);}}}};jsFlashHandler.getPlayer=function(A){if(theApp.is.ie10orLess) return(eval("document."+A));else{if (navigator.appVersion.indexOf("Mac")!=-1) return(eval(A));else{var B=document.getElementsByTagName('embed');for (var i=0;i<B.length;i++){if (B[i].name==A||B[i].id==A) return(window.document.embeds[i]);}}};if (theApp.is.ie) return(eval("document."+A));};jsFlashHandler.playerReadyRegister=function(A){jsFlashHandler.playerReadyRegCB=A;};jsFlashHandler.playerReadyUnRegister=function(){jsFlashHandler.playerReadyRegCB=n;};function playerReady(A){jsFlashHandler.playerState='IDLE';if(A&&A.id){var B=A.id;var C=document.getElementById(B);var D=n;if(C){var E=0;var F=function(){var G=jsFlashHandler.getPlayer(B);D=C.cwObj;if(!D){for(var i=0,H=C.parentNode;i<100&&H&&!H.tObj;i++) H=H.parentNode;if(H&&H.tObj){D=H.tObj.cwObj;C.wndObj=H.tObj;C.cwObj=H.tObj.cwObj;}};var I=f;if(D){if (D.arChld) for (var i=0;i<D.arChld.length;i++){var o=D.arChld[i];if (o.type==6&&o.on==6){I=t;break;}};G.addModelListener('STATE','jsFlashHandler.FlashStateChange');if(D.hasEvents()) {G.addModelListener('TIME','jsFlashHandler.FlashTimeChange');}};if(!D){if(E<5){E++;setTimeout(function() { F();},500);}else{window.status='Flash player not initialized properly. Events may not work.';setTimeout(function() { window.status='';},5000);}}};F();}};if (jsFlashHandler.playerReadyRegCB) jsFlashHandler.playerReadyRegCB(A);};function wndPageDrawLine(A,B,C,D,E,F){if(A>C){var t=A;A=C;C=t;t=B;B=D;D=t;};var G=Math.abs(C-A);var H=Math.abs(D-B);var I=(E==undefined?3:E);var J=0,K=0,L=0,M=0;var N=document.createElement('div');N.id='line';var O=N.style;O.position='absolute';O.left=Math.min(A,C)+'px';O.top=Math.min(B,D)+'px';O.width='1px';O.height='1px';O.zIndex=99000;this.div.appendChild(N);var P=function(Q,l,t,w,h,c){var R=document.createElement('div');var S=R.style;S.position='absolute';S.left=l+'px';S.top=t+'px';S.width=w+'px';S.height=h+'px';S.backgroundColor=(c==undefined?"#0000FF":c);S.overflow='hidden';Q.appendChild(R);};if(G>H){J=0;L=0;while(J<G){K=J;while ((Math.round(J*H/G)==L)&&(J<=G)) J++;P(N,(D>B?K:(G-J)),L,(J-K+I),I,F);L++;}}else{M=0;K=0;while(M<H){L=M;while((Math.round(M*G/H)==K)&&(M<H)) M++;P(N,(D>B?K:(G-K)),L,I,(M-L+I),F);K++;}};return N;};p=n;
